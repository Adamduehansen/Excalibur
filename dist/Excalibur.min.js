/*! excalibur - v0.3.0 - 2015-04-04
* https://github.com/excaliburjs/Excalibur
* Copyright (c) 2015 ; Licensed BSD*/
var __extends,ex;typeof window=="undefined"&&(window={audioContext:function(){}});typeof window=="undefined"||window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(n){window.setInterval(n,1e3/60)});typeof window=="undefined"||window.AudioContext||(window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext);Array.prototype.forEach||(Array.prototype.forEach=function(n,t){var u,i,r,f,e;if(this==null)throw new TypeError(" this is null or not defined");if(r=Object(this),f=r.length>>>0,typeof n!="function")throw new TypeError(n+" is not a function");for(arguments.length>1&&(u=t),i=0;i<f;)i in r&&(e=r[i],n.call(u,e,i,r)),i++});Array.prototype.some||(Array.prototype.some=function(n){"use strict";var i,r,u,t;if(this===void 0||this===null)throw new TypeError;if(i=Object(this),r=i.length>>>0,typeof n!="function")throw new TypeError;for(u=arguments.length>=2?arguments[1]:void 0,t=0;t<r;t++)if(t in i&&n.call(u,i[t],t,i))return!0;return!1});Function.prototype.bind||(Function.prototype.bind=function(n){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var r=Array.prototype.slice.call(arguments,1),u=this,t=function(){},i=function(){return u.apply(this instanceof t&&n?this:n,r.concat(Array.prototype.slice.call(arguments)))};return t.prototype=this.prototype,i.prototype=new t,i}),function(n){var t;(function(t){var c=function(){function n(){}return n.prototype.updatePixel=function(n,t,i){var r=(n+t*i.width)*4,u=i.data,f=(u[r+0]+u[r+1]+u[r+2])/3;u[r+0]=f;u[r+1]=f;u[r+2]=f},n}(),i,r,u,f,e,o,s,h;t.Grayscale=c;i=function(){function n(){}return n.prototype.updatePixel=function(n,t,i){var r=(n+t*i.width)*4,u=i.data;u[r+0]=255-u[r+0];u[r+1]=255-u[r+1];u[r+2]=255-u[r+2]},n}();t.Invert=i;r=function(){function n(n){this.opacity=n}return n.prototype.updatePixel=function(n,t,i){var r=(n+t*i.width)*4,u=i.data;u[r+3]!==0&&(u[r+3]=Math.round(this.opacity*255))},n}();t.Opacity=r;u=function(){function n(n){this.color=n}return n.prototype.updatePixel=function(n,t,i){var r=(n+t*i.width)*4,u=i.data;u[r+3]!==0&&(u[r+0]=(u[r+0]+this.color.r)/2,u[r+1]=(u[r+1]+this.color.g)/2,u[r+2]=(u[r+2]+this.color.b)/2)},n}();t.Colorize=u;f=function(){function t(n){n===void 0&&(n=.1);this.factor=n}return t.prototype.updatePixel=function(t,i,r){var u=(t+i*r.width)*4,f=r.data,e=n.Color.fromRGB(f[u+0],f[u+1],f[u+2],f[u+3]).lighten(this.factor);f[u+0]=e.r;f[u+1]=e.g;f[u+2]=e.b;f[u+3]=e.a},t}();t.Lighten=f;e=function(){function t(n){n===void 0&&(n=.1);this.factor=n}return t.prototype.updatePixel=function(t,i,r){var u=(t+i*r.width)*4,f=r.data,e=n.Color.fromRGB(f[u+0],f[u+1],f[u+2],f[u+3]).darken(this.factor);f[u+0]=e.r;f[u+1]=e.g;f[u+2]=e.b;f[u+3]=e.a},t}();t.Darken=e;o=function(){function t(n){n===void 0&&(n=.1);this.factor=n}return t.prototype.updatePixel=function(t,i,r){var u=(t+i*r.width)*4,f=r.data,e=n.Color.fromRGB(f[u+0],f[u+1],f[u+2],f[u+3]).saturate(this.factor);f[u+0]=e.r;f[u+1]=e.g;f[u+2]=e.b;f[u+3]=e.a},t}();t.Saturate=o;s=function(){function t(n){n===void 0&&(n=.1);this.factor=n}return t.prototype.updatePixel=function(t,i,r){var u=(t+i*r.width)*4,f=r.data,e=n.Color.fromRGB(f[u+0],f[u+1],f[u+2],f[u+3]).desaturate(this.factor);f[u+0]=e.r;f[u+1]=e.g;f[u+2]=e.b;f[u+3]=e.a},t}();t.Desaturate=s;h=function(){function n(n){this.color=n}return n.prototype.updatePixel=function(n,t,i){var r=(n+t*i.width)*4,u=i.data;u[r+3]!==0&&(u[r+0]=this.color.r,u[r+1]=this.color.g,u[r+2]=this.color.b)},n}();t.Fill=h})(t=n.Effects||(n.Effects={}))}(ex||(ex={})),function(n){var t=function(){function n(){}return n.prototype.update=function(n,t,i){n.x+=n.dx*i/1e3;n.y+=n.dy*i/1e3;n.dx+=n.ax*i/1e3;n.dy+=n.ay*i/1e3;n.rotation+=n.rx*i/1e3;n.scale.x+=n.sx*i/1e3;n.scale.y+=n.sy*i/1e3},n}();n.MovementModule=t}(ex||(ex={})),function(n){var t=function(){function t(){}return t.prototype.update=function(t,i){var o=t.eventDispatcher,s=t.anchor,h=t.getGlobalScale(),f=h.x*t.getWidth()/t.scale.x,e=h.y*t.getHeight()/t.scale.y,r=i.worldToScreenCoordinates(new n.Point(t.getWorldX()-s.x*f,t.getWorldY()-s.y*e)),u=1;t.scene&&t.scene.camera&&(u=t.scene.camera.getZoom());t.isOffScreen?r.x+f*u>0&&r.y+e*u>0&&r.x<i.width&&r.y<i.height&&(o.publish("enterviewport",new n.EnterViewPortEvent),t.isOffScreen=!1):(r.x+f*u<0||r.y+e*u<0||r.x>i.width||r.y>i.height)&&(o.publish("exitviewport",new n.ExitViewPortEvent),t.isOffScreen=!0)},t}();n.OffscreenCullingModule=t}(ex||(ex={})),function(n){var t=function(){function n(){}return n.prototype.update=function(n,t){n.enableCapturePointer&&(n.isKilled()||t.input.pointers.propogate(n))},n}();n.CapturePointerModule=t}(ex||(ex={})),function(n){var t=function(){function t(){}return t.prototype.update=function(t,i){var o=t.eventDispatcher,f;if(t.collisionType!==0)for(f=0;f<i.currentScene.tileMaps.length;f++)for(var s=i.currentScene.tileMaps[f],u,r=0,h=2,e=!1;u=s.collides(t);){if(h--<0)break;r=t.getSideFromIntersect(u);o.publish("collision",new n.CollisionEvent(t,null,r,u));(t.collisionType===2||t.collisionType===3)&&(t.y+=u.y,t.x+=u.x,t.collisionType!==3||e||(e=!0,r===3?t.dx=Math.abs(t.dx):r===4?t.dx=-Math.abs(t.dx):r===1?t.dy=Math.abs(t.dy):r===2&&(t.dy=-Math.abs(t.dy))))}},t}();n.CollisionDetectionModule=t}(ex||(ex={})),function(n){(function(n){n[n.None=0]="None";n[n.Top=1]="Top";n[n.Bottom=2]="Bottom";n[n.Left=3]="Left";n[n.Right=4]="Right"})(n.Side||(n.Side={}));var t=n.Side}(ex||(ex={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){var t=function(){function t(n,t){this.x=n;this.y=t}return t.prototype.toVector=function(){return new i(this.x,this.y)},t.prototype.rotate=function(i,r){r||(r=new n.Point(0,0));var u=Math.sin(i),f=Math.cos(i),e=f*(this.x-r.x)-u*(this.y-r.y)+r.x,o=u*(this.x-r.x)+f*(this.y-r.y)+r.y;return new t(e,o)},t.prototype.add=function(n){return new t(this.x+n.x,this.y+n.y)},t.prototype.setTo=function(n,t){this.x=n;this.y=t},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.equals=function(n){return this.x===n.x&&this.y===n.y},t}(),i,r,u,f;n.Point=t;i=function(n){function i(t,i){n.call(this,t,i);this.x=t;this.y=i}return __extends(i,n),i.fromAngle=function(n){return new i(Math.cos(n),Math.sin(n))},i.prototype.distance=function(n){return n||(n=new i(0,0)),Math.sqrt(Math.pow(this.x-n.x,2)+Math.pow(this.y-n.y,2))},i.prototype.normalize=function(){var n=this.distance();return n>0?new i(this.x/n,this.y/n):new i(0,1)},i.prototype.scale=function(n){return new i(this.x*n,this.y*n)},i.prototype.plus=function(n){return this.add(n)},i.prototype.add=function(n){return new i(this.x+n.x,this.y+n.y)},i.prototype.subtract=function(n){return this.minus(n)},i.prototype.minus=function(n){return new i(this.x-n.x,this.y-n.y)},i.prototype.dot=function(n){return this.x*n.x+this.y*n.y},i.prototype.cross=function(n){return this.x*n.y-this.y*n.x},i.prototype.perpendicular=function(){return new i(this.y,-this.x)},i.prototype.normal=function(){return this.perpendicular().normalize()},i.prototype.toAngle=function(){return Math.atan2(this.y,this.x)},i.prototype.toPoint=function(){return new t(this.x,this.y)},i.prototype.rotate=function(t,i){return n.prototype.rotate.call(this,t,i).toVector()},i.prototype.clone=function(){return new i(this.x,this.y)},i.Zero=new i(0,0),i}(t);n.Vector=i;r=function(){function n(n,t){this.pos=n;this.dir=t.normalize()}return n.prototype.intersect=function(n){var i=n.begin.toVector().minus(this.pos.toVector()),t,r,u;return this.dir.cross(n.getSlope())===0&&i.cross(this.dir)!==0?-1:(t=this.dir.cross(n.getSlope()),t===0)?-1:(r=i.cross(n.getSlope())/t,r>=0&&(u=i.cross(this.dir)/t/n.getLength(),u>=0&&u<=1))?r:-1},n.prototype.getPoint=function(n){return this.pos.toVector().add(this.dir.scale(n)).toPoint()},n}();n.Ray=r;u=function(){function n(n,t){this.begin=n;this.end=t}return n.prototype.getSlope=function(){var n=this.begin.toVector(),t=this.end.toVector(),i=n.distance(t);return t.minus(n).scale(1/i)},n.prototype.getLength=function(){var n=this.begin.toVector(),t=this.end.toVector();return n.distance(t)},n}();n.Line=u;f=function(){function n(n,t){this.min=n;this.max=t}return n.prototype.overlaps=function(n){return this.max>n.min&&n.max>this.min},n.prototype.getOverlap=function(n){return this.overlaps(n)?this.max>n.max?n.max-this.min:this.max-n.min:0},n}();n.Projection=f}(ex||(ex={})),function(n){var t;(function(t){function r(n){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o="",i=0;i<n.length;){var s=n.charCodeAt(i++)&255,r=n.charCodeAt(i++)&255,u=n.charCodeAt(i++)&255,h=s>>2,c=(s&3)<<4|r>>4,f,e;isNaN(r)?f=e=64:(f=(r&15)<<2|u>>6,e=isNaN(u)?64:u&63);o+=t.charAt(h)+t.charAt(c)+t.charAt(f)+t.charAt(e)}return o}function u(n,t,i){return n<=t?t:n>=i?i:n}function f(n,t,i,r,u,f){n.beginPath();n.strokeStyle=t;n.moveTo(i,r);n.lineTo(u,f);n.closePath();n.stroke()}function i(n,t){return n+Math.random()*(t-n)}function e(n,t){return Math.round(i(n,t))}function o(n){var t=n;if(n>this.TwoPI)while(t>this.TwoPI)t-=this.TwoPI;if(n<0)while(t<0)t+=this.TwoPI;return t}function s(n){return 180/Math.PI*n}function h(n){return n/180*Math.PI}function c(t){var i=0,r=0,u=function(n){i+=n.offsetLeft;n.offsetParent&&u(n.offsetParent)},f=function(n){r+=n.offsetTop;n.offsetParent&&f(n.offsetParent)};return u(t),f(t),new n.Point(i,r)}function l(n,t){return t.indexOf(n)===-1?(t.push(n),!0):!1}function a(n,t){var i=-1;return(i=t.indexOf(n))>-1?(t.splice(i,1),!0):!1}function v(n){return n===1?2:n===2?1:n===3?4:n===4?3:0}t.TwoPI=Math.PI*2;t.base64Encode=r;t.clamp=u;t.drawLine=f;t.randomInRange=i;t.randomIntInRange=e;t.canonicalizeAngle=o;t.toDegrees=s;t.toRadians=h;t.getPosition=c;t.addItemToArray=l;t.removeItemToArray=a;t.getOppositeSide=v;var y=function(){function n(t){t===void 0&&(t=n.DefaultSize);this.internalArray=null;this.endPointer=0;this.internalArray=new Array(t)}return n.prototype.resize=function(){for(var i=this.internalArray.length*2,t=new Array(i),r=this.count(),n=0;n<r;n++)t[n]=this.internalArray[n];delete this.internalArray;this.internalArray=t},n.prototype.push=function(n){return this.endPointer===this.internalArray.length&&this.resize(),this.internalArray[this.endPointer++]=n},n.prototype.pop=function(){return this.endPointer=this.endPointer-1<0?0:this.endPointer-1,this.internalArray[this.endPointer]},n.prototype.count=function(){return this.endPointer},n.prototype.clear=function(){this.endPointer=0},n.prototype.internalSize=function(){return this.internalArray.length},n.prototype.elementAt=function(n){if(!(n>=this.count()))return this.internalArray[n]},n.prototype.insert=function(n,t){return n>=this.count()&&this.resize(),this.internalArray[n]=t},n.prototype.remove=function(n){var i=this.count(),r,t;if(i!==0){for(r=this.internalArray[n],t=n;t<i;t++)this.internalArray[t]=this.internalArray[t+1];return this.endPointer--,r}},n.prototype.removeElement=function(n){var t=this.internalArray.indexOf(n);this.remove(t)},n.prototype.toArray=function(){return this.internalArray.slice(0,this.endPointer)},n.prototype.forEach=function(n){for(var i=this.count(),t=0;t<i;t++)n.call(this,this.internalArray[t],t)},n.prototype.map=function(n){for(var i=this.count(),t=0;t<i;t++)this.internalArray[t]=n.call(this,this.internalArray[t],t)},n.DefaultSize=200,n}();t.Collection=y})(t=n.Util||(n.Util={}))}(ex||(ex={})),function(n){var t=function(){function t(t,i,r,u,f){var e=this;this.sx=i;this.sy=r;this.swidth=u;this.sheight=f;this.rotation=0;this.anchor=new n.Point(0,0);this.scale=new n.Point(1,1);this.logger=n.Logger.getInstance();this.flipVertical=!1;this.flipHorizontal=!1;this.width=0;this.height=0;this.effects=[];this.internalImage=new Image;this.spriteCanvas=null;this.spriteCtx=null;this.pixelData=null;this.pixelsLoaded=!1;this.dirtyEffect=!1;(i<0||r<0||u<0||f<0)&&this.logger.error("Sprite cannot have any negative dimensions x:",i,"y:",r,"width:",u,"height:",f);this._texture=t;this.spriteCanvas=document.createElement("canvas");this.spriteCanvas.width=u;this.spriteCanvas.height=f;this.spriteCtx=this.spriteCanvas.getContext("2d");this._texture.loaded.then(function(){e.spriteCanvas.width=e.spriteCanvas.width||e._texture.image.naturalWidth;e.spriteCanvas.height=e.spriteCanvas.height||e._texture.image.naturalHeight;e.loadPixels();e.dirtyEffect=!0}).error(function(n){e.logger.error("Error loading texture ",e._texture.path,n)});this.width=u;this.height=f}return t.prototype.loadPixels=function(){if(this._texture.isLoaded()&&!this.pixelsLoaded){var t=n.Util.clamp,i=this._texture.image.naturalWidth||0,r=this._texture.image.naturalHeight||0;this.swidth>i&&this.logger.warn("The sprite width",this.swidth,"exceeds the width",i,"of the backing texture",this._texture.path);this.sheight>r&&this.logger.warn("The sprite height",this.sheight,"exceeds the height",r,"of the backing texture",this._texture.path);this.spriteCtx.drawImage(this._texture.image,t(this.sx,0,i),t(this.sy,0,r),t(this.swidth,0,i),t(this.sheight,0,r),0,0,this.swidth,this.sheight);this.internalImage.src=this.spriteCanvas.toDataURL("image/png");this.pixelsLoaded=!0}},t.prototype.opacity=function(t){this.addEffect(new n.Effects.Opacity(t))},t.prototype.grayscale=function(){this.addEffect(new n.Effects.Grayscale)},t.prototype.invert=function(){this.addEffect(new n.Effects.Invert)},t.prototype.fill=function(t){this.addEffect(new n.Effects.Fill(t))},t.prototype.colorize=function(t){this.addEffect(new n.Effects.Colorize(t))},t.prototype.lighten=function(t){t===void 0&&(t=.1);this.addEffect(new n.Effects.Lighten(t))},t.prototype.darken=function(t){t===void 0&&(t=.1);this.addEffect(new n.Effects.Darken(t))},t.prototype.saturate=function(t){t===void 0&&(t=.1);this.addEffect(new n.Effects.Saturate(t))},t.prototype.desaturate=function(t){t===void 0&&(t=.1);this.addEffect(new n.Effects.Desaturate(t))},t.prototype.addEffect=function(n){this.effects.push(n);this._texture.isLoaded()&&this.pixelsLoaded?this.applyEffects():this.dirtyEffect=!0},t.prototype.removeEffect=function(n){var t=null;t=typeof n=="number"?n:this.effects.indexOf(n);this.effects.splice(t,1);this._texture.isLoaded()&&this.pixelsLoaded?this.applyEffects():this.dirtyEffect=!0},t.prototype.applyEffects=function(){var i=this,t=n.Util.clamp,r=this._texture.image.naturalWidth||0,u=this._texture.image.naturalHeight||0;this.spriteCtx.clearRect(0,0,this.swidth,this.sheight);this.spriteCtx.drawImage(this._texture.image,t(this.sx,0,r),t(this.sy,0,u),t(this.swidth,0,r),t(this.sheight,0,u),0,0,this.swidth,this.sheight);this.pixelData=this.spriteCtx.getImageData(0,0,this.swidth,this.sheight);this.effects.forEach(function(n){for(var r,t=0;t<i.sheight;t++)for(r=0;r<i.swidth;r++)n.updatePixel(r,t,i.pixelData)});this.spriteCtx.clearRect(0,0,this.swidth,this.sheight);this.spriteCtx.putImageData(this.pixelData,0,0);this.internalImage.src=this.spriteCanvas.toDataURL("image/png")},t.prototype.clearEffects=function(){this.effects.length=0;this.applyEffects()},t.prototype.reset=function(){},t.prototype.debugDraw=function(t,i,r){t.save();t.translate(i,r);t.rotate(this.rotation);var u=this.width*this.scale.x*this.anchor.x,f=this.height*this.scale.y*this.anchor.y;t.strokeStyle=n.Color.Black;t.strokeRect(-u,-f,this.width*this.scale.x,this.height*this.scale.y);t.restore()},t.prototype.draw=function(n,t,i){this.dirtyEffect&&(this.applyEffects(),this.dirtyEffect=!1);n.save();var r=this.width*this.scale.x*this.anchor.x,u=this.height*this.scale.y*this.anchor.y;n.translate(t,i);n.rotate(this.rotation);this.flipHorizontal&&(n.translate(this.swidth*this.scale.x,0),n.scale(-1,1));this.flipVertical&&(n.translate(0,this.sheight*this.scale.y),n.scale(1,-1));this.internalImage&&n.drawImage(this.internalImage,0,0,this.swidth,this.sheight,-r,-u,this.swidth*this.scale.x,this.sheight*this.scale.y);n.restore()},t.prototype.clone=function(){var n=new t(this._texture,this.sx,this.sy,this.swidth,this.sheight);return n.scale=this.scale.clone(),n.rotation=this.rotation,n.flipHorizontal=this.flipHorizontal,n.flipVertical=this.flipVertical,this.effects.forEach(function(t){n.addEffect(t)}),n},t}();n.Sprite=t}(ex||(ex={})),function(n){var t=function(){function t(t,i,r,u,f){this.image=t;this.columns=i;this.rows=r;this.sprites=[];this.internalImage=t.image;this.sprites=new Array(i*r);for(var e=0,o=0,e=0;e<r;e++)for(o=0;o<i;o++)this.sprites[o+e*i]=new n.Sprite(this.image,o*u,e*f,u,f)}return t.prototype.getAnimationByIndices=function(t,i,r){var f=this,u=i.map(function(n){return f.sprites[n]});return u=u.map(function(n){return n.clone()}),new n.Animation(t,u,r)},t.prototype.getAnimationBetween=function(t,i,r,u){var f=this.sprites.slice(i,r);return f=f.map(function(n){return n.clone()}),new n.Animation(t,f,u)},t.prototype.getAnimationForAll=function(t,i){var r=this.sprites.map(function(n){return n.clone()});return new n.Animation(t,r,i)},t.prototype.getSprite=function(n){if(n>=0&&n<this.sprites.length)return this.sprites[n]},t}(),i;n.SpriteSheet=t;i=function(t){function i(i,r,u,f,e,o,s){t.call(this,i,f,e,o,s);this.image=i;this.alphabet=r;this.caseInsensitive=u;this.spriteLookup={};this.colorLookup={};this._currentColor=n.Color.Black}return __extends(i,t),i.prototype.getTextSprites=function(){for(var t,i={},n=0;n<this.alphabet.length;n++)t=this.alphabet[n],this.caseInsensitive&&(t=t.toLowerCase()),i[t]=this.sprites[n].clone();return i},i}(t);n.SpriteFont=i}(ex||(ex={})),function(n){var r=function(){function n(n,t){this.spriteSheetKey=n;this.spriteId=t}return n}(),t,i;n.TileSprite=r;t=function(){function t(t,i,r,u,f,e,o){e===void 0&&(e=!1);o===void 0&&(o=[]);this.x=t;this.y=i;this.width=r;this.height=u;this.index=f;this.solid=e;this.sprites=o;this._bounds=new n.BoundingBox(this.x,this.y,this.x+this.width,this.y+this.height)}return t.prototype.getBounds=function(){return this._bounds},t.prototype.getCenter=function(){return new n.Vector(this.x+this.width/2,this.y+this.height/2)},t.prototype.pushSprite=function(n){this.sprites.push(n)},t.prototype.removeSprite=function(n){var t=-1;(t=this.sprites.indexOf(n))>-1&&this.sprites.splice(t,1)},t.prototype.clearSprites=function(){this.sprites.length=0},t}();n.Cell=t;i=function(){function i(i,r,u,f,e,o){var c=this,s,h;for(this.x=i,this.y=r,this.cellWidth=u,this.cellHeight=f,this.rows=e,this.cols=o,this._collidingX=-1,this._collidingY=-1,this._onScreenXStart=0,this._onScreenXEnd=9999,this._onScreenYStart=0,this._onScreenYEnd=9999,this._spriteSheets={},this.logger=n.Logger.getInstance(),this.data=[],this.data=new Array(e*o),s=0;s<o;s++)for(h=0;h<e;h++)(function(){var n=new t(s*u+i,h*f+r,u,f,s+h*o);c.data[s+h*o]=n})()}return i.prototype.registerSpriteSheet=function(n,t){this._spriteSheets[n]=t},i.prototype.collides=function(t){for(var r,i,u,s,h=t.x+t.getWidth(),c=t.y+t.getHeight(),f=t.getBounds(),e=[],o=f.left;o<=h;o+=Math.min(t.getWidth()/2,this.cellWidth/2))for(r=f.top;r<=c;r+=Math.min(t.getHeight()/2,this.cellHeight/2))i=this.getCellByPoint(o,r),i&&i.solid&&(u=f.collides(i.getBounds()),s=t.getCenter().minus(i.getCenter()),u&&u.dot(s)>0&&e.push(u));return e.length===0?null:e.reduce(function(t,i){var r=t.x,u=t.y;return Math.abs(t.x)<Math.abs(i.x)&&(r=i.x),Math.abs(t.y)<Math.abs(i.y)&&(u=i.y),new n.Vector(r,u)})},i.prototype.getCellByIndex=function(n){return this.data[n]},i.prototype.getCell=function(n,t){return n<0||t<0||n>=this.cols||t>=this.rows?null:this.data[n+t*this.cols]},i.prototype.getCellByPoint=function(n,t){var n=Math.floor((n-this.x)/this.cellWidth),t=Math.floor((t-this.y)/this.cellHeight),i=this.getCell(n,t);return n>=0&&t>=0&&n<this.cols&&t<this.rows&&i?i:null},i.prototype.update=function(t){var i=t.screenToWorldCoordinates(new n.Point(0,0)),r=t.screenToWorldCoordinates(new n.Point(t.width,t.height));this._onScreenXStart=Math.max(Math.floor(i.x/this.cellWidth)-2,0);this._onScreenYStart=Math.max(Math.floor((i.y-this.y)/this.cellHeight)-2,0);this._onScreenXEnd=Math.max(Math.floor(r.x/this.cellWidth)+2,0);this._onScreenYEnd=Math.max(Math.floor((r.y-this.y)/this.cellHeight)+2,0)},i.prototype.draw=function(n){var t=this,i,r;for(n.save(),n.translate(this.x,this.y),i=this._onScreenXStart;i<Math.min(this._onScreenXEnd,this.cols);i++)for(r=this._onScreenYStart;r<Math.min(this._onScreenYEnd,this.rows);r++)this.getCell(i,r).sprites.filter(function(n){return n.spriteId>-1}).forEach(function(u){var f=t._spriteSheets[u.spriteSheetKey],e;f?(e=f.getSprite(u.spriteId),e?e.draw(n,i*t.cellWidth,r*t.cellHeight):t.logger.warn("Sprite does not exist for id",u.spriteId,"in sprite sheet",u.spriteSheetKey,e,f)):t.logger.warn("Sprite sheet",u.spriteSheetKey,"does not exist",f)});n.restore()},i.prototype.debugDraw=function(t){var f=this.cols*this.cellWidth,e=this.rows*this.cellHeight,i,r,u;for(t.save(),t.strokeStyle=n.Color.Red.toString(),i=0;i<this.cols+1;i++)t.beginPath(),t.moveTo(this.x+i*this.cellWidth,this.y),t.lineTo(this.x+i*this.cellWidth,this.y+e),t.stroke();for(r=0;r<this.rows+1;r++)t.beginPath(),t.moveTo(this.x,this.y+r*this.cellHeight),t.lineTo(this.x+f,this.y+r*this.cellHeight),t.stroke();u=n.Color.Red.clone();u.a=.3;this.data.filter(function(n){return n.solid}).forEach(function(n){t.fillStyle=u.toString();t.fillRect(n.x,n.y,n.width,n.height)});this._collidingY>-1&&this._collidingX>-1&&(t.fillStyle=n.Color.Cyan.toString(),t.fillRect(this.x+this._collidingX*this.cellWidth,this.y+this._collidingY*this.cellHeight,this.cellWidth,this.cellHeight));t.restore()},i}();n.TileMap=i}(ex||(ex={})),function(n){var r,t,i;(function(n){n[n.Naive=0]="Naive";n[n.DynamicAABBTree=1]="DynamicAABBTree";n[n.SeparatingAxis=2]="SeparatingAxis"})(n.CollisionStrategy||(n.CollisionStrategy={}));r=n.CollisionStrategy;t=function(){function t(n,t,i,r){n===void 0&&(n=0);t===void 0&&(t=0);i===void 0&&(i=0);r===void 0&&(r=0);this.left=n;this.top=t;this.right=i;this.bottom=r}return t.prototype.getWidth=function(){return this.right-this.left},t.prototype.getHeight=function(){return this.bottom-this.top},t.prototype.getPerimeter=function(){var n=this.getWidth(),t=this.getHeight();return 2*(n+t)},t.prototype.contains=function(i){return i instanceof n.Point?this.left<=i.x&&this.top<=i.y&&this.bottom>=i.y&&this.right>=i.x:i instanceof t?this.left<i.left&&this.top<i.top&&i.bottom<this.bottom&&i.right<this.right?!0:!1:!1},t.prototype.combine=function(n){return new t(Math.min(this.left,n.left),Math.min(this.top,n.top),Math.max(this.right,n.right),Math.max(this.bottom,n.bottom))},t.prototype.collides=function(i){var r,e,u,f;return i instanceof t?(r=i,e=this.combine(r),e.getWidth()<r.getWidth()+this.getWidth()&&e.getHeight()<r.getHeight()+this.getHeight()?(u=0,u=this.right>=r.left&&this.right<=r.right?r.left-this.right:r.right-this.left,f=0,f=this.top<=r.bottom&&this.top>=r.top?r.bottom-this.top:r.top-this.bottom,Math.abs(u)<Math.abs(f)?new n.Vector(u,0):new n.Vector(0,f)):null):null},t.prototype.debugDraw=function(n){n.lineWidth=2;n.strokeRect(this.left,this.top,this.getWidth(),this.getHeight())},t}();n.BoundingBox=t;i=function(){function t(n){this._points=n.map(function(n){return n.toVector()})}return t.prototype.getSides=function(){for(var i=[],r=this._points.length,t=0;t<r;t++)i.push(new n.Line(this._points[t],this._points[(t+1)%r]));return i},t.prototype.getAxes=function(){for(var t=[],i=this._points.length,n=0;n<i;n++)t.push(this._points[n].minus(this._points[(n+1)%i]).normal());return t},t.prototype.project=function(t){for(var i=[],u=this._points.length,r=0;r<u;r++)i.push(this._points[r].dot(t));return new n.Projection(Math.min.apply(Math,i),Math.max.apply(Math,i))},t.prototype.getWidth=function(){var n=this._points.reduce(function(n,t){return Math.min(n,t.x)},Infinity),t=this._points.reduce(function(n,t){return Math.max(n,t.x)},-Infinity);return t-n},t.prototype.getHeight=function(){var n=this._points.reduce(function(n,t){return Math.min(n,t.y)},Infinity),t=this._points.reduce(function(n,t){return Math.max(n,t.y)},-Infinity);return n-t},t.prototype.contains=function(t){var i=new n.Ray(t,new n.Vector(1,0)),r=this.getSides().reduce(function(n,t){return i.intersect(t)>=0?n+1:n},0);return r%2==0?!1:!0},t.prototype.collides=function(n){var e,i,u,f,r;if(n instanceof t){for(e=n,i=this.getAxes(),i=e.getAxes().concat(i),u=99999,f=null,r=0;r<i.length;r++){var s=this.project(i[r]),h=e.project(i[r]),o=s.getOverlap(h);if(o===0)return null;o<=u&&(u=o,f=i[r])}return f?f.normalize().scale(u):null}return null},t.prototype.debugDraw=function(t){t.beginPath();t.lineWidth=2;var i=this._points[0];t.moveTo(i.x,i.y);this._points.forEach(function(n){t.lineTo(n.x,n.y)});t.lineTo(i.x,i.y);t.closePath();t.strokeStyle=n.Color.Blue.toString();t.stroke()},t}();n.SATBoundingBox=i}(ex||(ex={})),function(n){var t=function(){function t(){this.eventDispatcher=new n.EventDispatcher(this)}return t.prototype.addEventListener=function(n,t){this.eventDispatcher.subscribe(n,t)},t.prototype.removeEventListener=function(n,t){this.eventDispatcher.unsubscribe(n,t)},t.prototype.on=function(n,t){this.eventDispatcher.subscribe(n,t)},t.prototype.off=function(n,t){this.eventDispatcher.unsubscribe(n,t)},t.extend=function(n){var f=this,i,u,r;if(i=n&&n.hasOwnProperty("constructor")?n.constructor:function(){return f.apply(this,arguments)},u=function(){this.constructor=i},u.prototype=f.prototype,i.prototype=new u,n)for(r in n)n.hasOwnProperty(r)&&(i.prototype[r]=n[r]);return i.extend=t.extend,i},t}();n.Class=t}(ex||(ex={})),function(n){var t=function(){function n(t,i,r){this.id=0;this.interval=10;this.fcn=function(){};this.repeats=!1;this.elapsedTime=0;this._totalTimeAlive=0;this.complete=!1;this.scene=null;this.id=n.id++;this.interval=i||this.interval;this.fcn=t||this.fcn;this.repeats=r||this.repeats}return n.prototype.update=function(n){this._totalTimeAlive+=n;this.elapsedTime+=n;this.elapsedTime>this.interval&&(this.fcn.call(this),this.repeats?this.elapsedTime=0:this.complete=!0)},n.prototype.getTimeRunning=function(){return this._totalTimeAlive},n.prototype.cancel=function(){this.scene&&this.scene.cancelTimer(this)},n.id=0,n}();n.Timer=t}(ex||(ex={})),function(n){var t=function(){function t(){}return t.prototype.register=function(){},t.prototype.remove=function(){},t.prototype.evaluate=function(t){for(var f,s,l,h,e=t.filter(function(n){return!n.isKilled()&&n.collisionType!==0}),i,o,r=[],u=0,c=e.length;u<c;u++)for(i=e[u],f=u+1;f<c;f++)o=e[f],(s=i.collides(o))&&(l=i.getSideFromIntersect(s),h=new n.CollisionPair(i,o,s,l),r.some(function(n){return n.equals(h)})||r.push(h));return r.forEach(function(n){return n.evaluate()}),r},t.prototype.update=function(){return 0},t.prototype.debugDraw=function(){},t}();n.NaiveCollisionResolver=t}(ex||(ex={})),function(n){var t=function(){function t(t){this.parent=t;this.parent=t||null;this.actor=null;this.bounds=new n.BoundingBox;this.left=null;this.right=null;this.height=0}return t.prototype.isLeaf=function(){return!this.left&&!this.right},t}(),i;n.TreeNode=t;i=function(){function n(){this.root=null;this.nodes={}}return n.prototype.insert=function(n){var e,r,o,y,f,u,i;if(this.root===null){this.root=n;this.root.parent=null;return}for(e=n.bounds,r=this.root;!r.isLeaf();){var s=r.left,h=r.right,k=r.bounds.getPerimeter(),d=r.bounds.combine(e),p=d.getPerimeter(),w=2*p,c=2*(p-k),l=0,b=e.combine(s.bounds),a,v;if(s.isLeaf()?l=b.getPerimeter()+c:(v=s.bounds.getPerimeter(),a=b.getPerimeter(),l=a-v+c),o=0,y=e.combine(h.bounds),h.isLeaf()?o=y.getPerimeter()+c:(v=h.bounds.getPerimeter(),a=y.getPerimeter(),o=a-v+c),w<l&&w<o)break;r=l<o?s:h}for(f=r.parent,u=new t(f),u.bounds=e.combine(r.bounds),u.height=r.height+1,f!==null?(f.left===r?f.left=u:f.right=u,u.left=r,u.right=n,r.parent=u,n.parent=u):(u.left=r,u.right=n,r.parent=u,n.parent=u,this.root=u),i=n.parent;i;){if(i=this.balance(i),!i.left)throw new Error("Parent of current leaf cannot have a null left child"+i);if(!i.right)throw new Error("Parent of current leaf cannot have a null right child"+i);i.height=1+Math.max(i.left.height,i.right.height);i.bounds=i.left.bounds.combine(i.right.bounds);i=i.parent}},n.prototype.remove=function(n){var r,i,u,t;if(n===this.root){this.root=null;return}if(r=n.parent,i=r.parent,u=r.left===n?r.right:r.left,i)for(i.left===r?i.left=u:i.right=u,u.parent=i,t=i;t;)t=this.balance(t),t.bounds=t.left.bounds.combine(t.right.bounds),t.height=1+Math.max(t.left.height,t.right.height),t=t.parent;else this.root=u,u.parent=null},n.prototype.registerActor=function(n){var i=new t;i.actor=n;i.bounds=n.getBounds();i.bounds.left-=2;i.bounds.top-=2;i.bounds.right+=2;i.bounds.bottom+=2;this.nodes[n.id]=i;this.insert(i)},n.prototype.updateActor=function(n){var i=this.nodes[n.id],t,r,u;if(i)return(t=n.getBounds(),i.bounds.contains(t))?!1:(this.remove(i),t.left-=5,t.top-=5,t.right+=5,t.bottom+=5,r=n.dx*2,u=n.dy*2,r<0?t.left+=r:t.right+=r,u<0?t.top+=u:t.bottom+=u,i.bounds=t,this.insert(i),!0)},n.prototype.removeActor=function(n){var t=this.nodes[n.id];t&&(this.remove(t),this.nodes[n.id]=null,delete this.nodes[n.id])},n.prototype.balance=function(n){if(n===null)throw new Error("Cannot balance at null node");if(n.isLeaf()||n.height<2)return n;var s=n.left,h=n.right,t=n,i=s,r=h,u=s.left,f=s.right,e=h.left,o=h.right,c=r.height-i.height;if(c>1)return r.left=t,r.parent=t.parent,t.parent=r,r.parent?r.parent.left===t?r.parent.left=r:r.parent.right=r:this.root=r,e.height>o.height?(r.right=e,t.right=o,o.parent=t,t.bounds=i.bounds.combine(o.bounds),r.bounds=t.bounds.combine(e.bounds),t.height=1+Math.max(i.height,o.height),r.height=1+Math.max(t.height,e.height)):(r.right=o,t.right=e,e.parent=t,t.bounds=i.bounds.combine(e.bounds),r.bounds=t.bounds.combine(o.bounds),t.height=1+Math.max(i.height,e.height),r.height=1+Math.max(t.height,o.height)),r;if(c<-1){if(i.left=t,i.parent=t.parent,t.parent=i,i.parent)if(i.parent.left===t)i.parent.left=i;else{if(i.parent.right!==t)throw"Error rotating Dynamic Tree";i.parent.right=i}else this.root=i;return u.height>f.height?(i.right=u,t.left=f,f.parent=t,t.bounds=r.bounds.combine(f.bounds),i.bounds=t.bounds.combine(u.bounds),t.height=1+Math.max(r.height,f.height),i.height=1+Math.max(t.height,u.height)):(i.right=f,t.left=u,u.parent=t,t.bounds=r.bounds.combine(u.bounds),i.bounds=t.bounds.combine(f.bounds),t.height=1+Math.max(r.height,u.height),i.height=1+Math.max(t.height,f.height)),i}return n},n.prototype.getHeight=function(){return this.root===null?0:this.root.height},n.prototype.query=function(n,t){var r=n.getBounds(),i=function(u){if(u&&u.bounds.collides(r))if(u.isLeaf()&&u.actor!==n){if(t.call(n,u.actor))return!0}else return i(u.left)||i(u.right);else return null};return i(this.root)},n.prototype.rayCast=function(){return null},n.prototype.getNodes=function(){var n=function(t){return t?[t].concat(n(t.left),n(t.right)):[]};return n(this.root)},n.prototype.debugDraw=function(n){var t=function(i){i&&(n.strokeStyle=i.isLeaf()?"green":"white",i.bounds.debugDraw(n),i.left&&t(i.left),i.right&&t(i.right))};t(this.root)},n}();n.DynamicTree=i}(ex||(ex={})),function(n){var t=function(){function t(){this._dynamicCollisionTree=new n.DynamicTree}return t.prototype.register=function(n){this._dynamicCollisionTree.registerActor(n)},t.prototype.remove=function(n){this._dynamicCollisionTree.removeActor(n)},t.prototype.evaluate=function(t){for(var f=t.filter(function(n){return!n.isKilled()&&n.collisionType!==0}),i,r=[],u=0,e=f.length;u<e;u++)i=f[u],this._dynamicCollisionTree.query(i,function(t){var u,e,f;return t.collisionType===0||t.isKilled()?!1:(u=i.collides(t))?(e=i.getSideFromIntersect(u),f=new n.CollisionPair(i,t,u,e),r.some(function(n){return n.equals(f)})||r.push(f),!0):!1});return r.forEach(function(n){return n.evaluate()}),r},t.prototype.update=function(n){var i=this,t=0;return n.forEach(function(n){i._dynamicCollisionTree.updateActor(n)&&t++}),t},t.prototype.debugDraw=function(n,t){this._dynamicCollisionTree.debugDraw(n,t)},t}();n.DynamicTreeCollisionResolver=t}(ex||(ex={})),function(n){var t=function(){function t(n,t,i,r){this.left=n;this.right=t;this.intersect=i;this.side=r}return t.prototype.equals=function(n){return n.left===this.left&&n.right===this.right||n.right===this.left&&n.left===this.right},t.prototype.evaluate=function(){var t,i,r;this.left.eventDispatcher.publish("collision",new n.CollisionEvent(this.left,this.right,this.side,this.intersect));this.right.eventDispatcher.publish("collision",new n.CollisionEvent(this.right,this.left,n.Util.getOppositeSide(this.side),this.intersect.scale(-1)));t=this.side;(this.left.collisionType===2||this.left.collisionType===3)&&this.right.collisionType!==1&&(this.left.y+=this.intersect.y,this.left.x+=this.intersect.x,this.left.collisionType===3&&(t===3?this.left.dx=Math.abs(this.left.dx):t===4?this.left.dx=-Math.abs(this.left.dx):t===1?this.left.dy=Math.abs(this.left.dy):t===2&&(this.left.dy=-Math.abs(this.left.dy))));i=n.Util.getOppositeSide(this.side);r=this.intersect.scale(-1);(this.right.collisionType===2||this.right.collisionType===3)&&this.left.collisionType!==1&&(this.right.y+=r.y,this.right.x+=r.x,this.right.collisionType===3&&(i===3?this.right.dx=Math.abs(this.right.dx):i===4?this.right.dx=-Math.abs(this.right.dx):i===1?this.right.dy=Math.abs(this.right.dy):i===2&&(this.right.dy=-Math.abs(this.right.dy))))},t}();n.CollisionPair=t}(ex||(ex={})),function(n){var t=function(){function t(){this.focus=new n.Point(0,0);this.lerp=!1;this._cameraMoving=!1;this._currentLerpTime=0;this._lerpDuration=1e3;this._totalLerpTime=0;this._lerpStart=null;this._lerpEnd=null;this.isShaking=!1;this.shakeMagnitudeX=0;this.shakeMagnitudeY=0;this.shakeDuration=0;this.elapsedShakeTime=0;this.isZooming=!1;this.currentZoomScale=1;this.maxZoomScale=1;this.zoomDuration=0;this.elapsedZoomTime=0;this.zoomIncrement=.01}return t.prototype.easeInOutCubic=function(n,t,i,r){return(i=i-t,n/=r/2,n<1)?i/2*n*n*n+t:(n-=2,i/2*(n*n*n+2)+t)},t.prototype.setActorToFollow=function(n){this.follow=n},t.prototype.getFocus=function(){return this.focus},t.prototype.setFocus=function(t,i){this.follow||this.lerp||(this.focus.x=t,this.focus.y=i);this.lerp&&(this._lerpStart=this.focus.clone(),this._lerpEnd=new n.Point(t,i),this._currentLerpTime=0,this._cameraMoving=!0)},t.prototype.shake=function(n,t,i){this.isShaking=!0;this.shakeMagnitudeX=n;this.shakeMagnitudeY=t;this.shakeDuration=i},t.prototype.zoom=function(n,t){this.isZooming=!0;this.maxZoomScale=n;this.zoomDuration=t|0;t&&(this.zoomIncrement=Math.abs(this.maxZoomScale-this.currentZoomScale)/t*1e3);this.maxZoomScale<1?t?this.zoomIncrement=-1*this.zoomIncrement:(this.isZooming=!1,this.setCurrentZoomScale(this.maxZoomScale)):t||(this.isZooming=!1,this.setCurrentZoomScale(this.maxZoomScale))},t.prototype.getZoom=function(){return this.currentZoomScale},t.prototype.setCurrentZoomScale=function(n){this.currentZoomScale=n},t.prototype.update=function(n,t){var i=this.getFocus(),r=0,u=0,f=n.canvas.width,e=n.canvas.height,o=f*this.getZoom(),s=e*this.getZoom();this.lerp&&(this._currentLerpTime<this._lerpDuration&&this._cameraMoving?(this.focus.x=this._lerpEnd.x<this._lerpStart.x?this._lerpStart.x-(this.easeInOutCubic(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):this.easeInOutCubic(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),this.focus.y=this._lerpEnd.y<this._lerpStart.y?this._lerpStart.y-(this.easeInOutCubic(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):this.easeInOutCubic(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this._currentLerpTime+=t):(this._lerpStart=null,this._lerpEnd=null,this._currentLerpTime=0,this._cameraMoving=!1));this.isDoneShaking()?(this.isShaking=!1,this.elapsedShakeTime=0,this.shakeMagnitudeX=0,this.shakeMagnitudeY=0,this.shakeDuration=0):(this.elapsedShakeTime+=t,r=(Math.random()*this.shakeMagnitudeX|0)+1,u=(Math.random()*this.shakeMagnitudeY|0)+1);n.translate(-i.x+r+o/2,-i.y+u+s/2);this.isDoneZooming()?(this.isZooming=!1,this.elapsedZoomTime=0,this.zoomDuration=0,this.setCurrentZoomScale(this.maxZoomScale)):(this.elapsedZoomTime+=t,this.setCurrentZoomScale(this.getZoom()+this.zoomIncrement*t/1e3));n.scale(this.getZoom(),this.getZoom())},t.prototype.debugDraw=function(n){var t=this.getFocus();n.fillStyle="red";n.beginPath();n.arc(t.x,t.y,15,0,Math.PI*2);n.closePath();n.fill()},t.prototype.isDoneShaking=function(){return!this.isShaking||this.elapsedShakeTime>=this.shakeDuration},t.prototype.isDoneZooming=function(){return this.zoomDuration!=0?this.elapsedZoomTime>=this.zoomDuration:this.maxZoomScale<1?this.currentZoomScale<=this.maxZoomScale:this.currentZoomScale>=this.maxZoomScale},t}(),i,r;n.BaseCamera=t;i=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.getFocus=function(){return this.follow?new n.Point(this.follow.x+this.follow.getWidth()/2,this.focus.y):this.focus},i}(t);n.SideCamera=i;r=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.getFocus=function(){return this.follow?new n.Point(this.follow.x+this.follow.getWidth()/2,this.follow.y+this.follow.getHeight()/2):this.focus},i}(t);n.TopCamera=r}(ex||(ex={})),function(n){var t;(function(t){var i;(function(t){var k=function(){function t(t,i,r,u,f){this.actor=t;this.easingFcn=f;this._currentLerpTime=0;this._lerpDuration=1e3;this._lerpStart=new n.Point(0,0);this._lerpEnd=new n.Point(0,0);this._initialized=!1;this._stopped=!1;this._distance=0;this._lerpDuration=u;this._lerpEnd=new n.Point(i,r)}return t.prototype._initialize=function(){this._lerpStart=new n.Point(this.actor.x,this.actor.y);this._currentLerpTime=0;this._distance=this._lerpStart.toVector().distance(this._lerpEnd.toVector())},t.prototype.update=function(n){this._initialized||(this._initialize(),this._initialized=!0);var t=this.actor.x,i=this.actor.y;this._currentLerpTime<this._lerpDuration?(t=this._lerpEnd.x<this._lerpStart.x?this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),i=this._lerpEnd.y<this._lerpStart.y?this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this.actor.x=t,this.actor.y=i,this._currentLerpTime+=n):(this.actor.x=this._lerpEnd.x,this.actor.y=this._lerpEnd.y)},t.prototype.isComplete=function(t){return this._stopped||new n.Vector(t.x,t.y).distance(this._lerpStart.toVector())>=this._distance},t.prototype.reset=function(){this._initialized=!1},t.prototype.stop=function(){this._stopped=!0},t}(),r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,i;t.EaseTo=k;r=function(){function t(t,i,r,u){this._started=!1;this._stopped=!1;this.actor=t;this.end=new n.Vector(i,r);this.speed=u}return t.prototype.update=function(){this._started||(this._started=!0,this.start=new n.Vector(this.actor.x,this.actor.y),this.distance=this.start.distance(this.end),this.dir=this.end.minus(this.start).normalize());var t=this.dir.scale(this.speed);this.actor.dx=t.x;this.actor.dy=t.y;this.isComplete(this.actor)&&(this.actor.x=this.end.x,this.actor.y=this.end.y,this.actor.dy=0,this.actor.dx=0)},t.prototype.isComplete=function(t){return this._stopped||new n.Vector(t.x,t.y).distance(this.start)>=this.distance},t.prototype.stop=function(){this.actor.dy=0;this.actor.dx=0;this._stopped=!0},t.prototype.reset=function(){this._started=!1},t}();t.MoveTo=r;u=function(){function t(t,i,r,u){if(this._started=!1,this._stopped=!1,this.actor=t,this.end=new n.Vector(i,r),u<=0){n.Logger.getInstance().error("Attempted to moveBy time less than or equal to zero : "+u);throw new Error("Cannot move in time <= 0");}this.time=u}return t.prototype.update=function(){this._started||(this._started=!0,this.start=new n.Vector(this.actor.x,this.actor.y),this.distance=this.start.distance(this.end),this.dir=this.end.minus(this.start).normalize(),this.speed=this.distance/(this.time/1e3));var t=this.dir.scale(this.speed);this.actor.dx=t.x;this.actor.dy=t.y;this.isComplete(this.actor)&&(this.actor.x=this.end.x,this.actor.y=this.end.y,this.actor.dy=0,this.actor.dx=0)},t.prototype.isComplete=function(t){return this._stopped||new n.Vector(t.x,t.y).distance(this.start)>=this.distance},t.prototype.stop=function(){this.actor.dy=0;this.actor.dx=0;this._stopped=!0},t.prototype.reset=function(){this._started=!1},t}();t.MoveBy=u;f=function(){function t(t,i,r){this._started=!1;this._stopped=!1;this.actor=t;this.actorToFollow=i;this.current=new n.Vector(this.actor.x,this.actor.y);this.end=new n.Vector(i.x,i.y);this.maximumDistance=r!=undefined?r:this.current.distance(this.end);this.speed=0}return t.prototype.update=function(){var n,t;this._started||(this._started=!0,this.distanceBetween=this.current.distance(this.end),this.dir=this.end.minus(this.current).normalize());n=Math.sqrt(Math.pow(this.actorToFollow.dx,2)+Math.pow(this.actorToFollow.dy,2));n!=0&&(this.speed=n);this.current.x=this.actor.x;this.current.y=this.actor.y;this.end.x=this.actorToFollow.x;this.end.y=this.actorToFollow.y;this.distanceBetween=this.current.distance(this.end);this.dir=this.end.minus(this.current).normalize();this.distanceBetween>=this.maximumDistance?(t=this.dir.scale(this.speed),this.actor.dx=t.x,this.actor.dy=t.y):(this.actor.dx=0,this.actor.dy=0);this.isComplete(this.actor)&&(this.actor.x=this.end.x,this.actor.y=this.end.y,this.actor.dy=0,this.actor.dx=0)},t.prototype.stop=function(){this.actor.dy=0;this.actor.dx=0;this._stopped=!0},t.prototype.isComplete=function(){return this._stopped},t.prototype.reset=function(){this._started=!1},t}();t.Follow=f;e=function(){function t(t,i,r){this._started=!1;this._stopped=!1;this._speedWasSpecified=!1;this.actor=t;this.actorToMeet=i;this.current=new n.Vector(this.actor.x,this.actor.y);this.end=new n.Vector(i.x,i.y);this.speed=r||0;r!=undefined&&(this._speedWasSpecified=!0)}return t.prototype.update=function(){var n,t;this._started||(this._started=!0,this.distanceBetween=this.current.distance(this.end),this.dir=this.end.minus(this.current).normalize());n=Math.sqrt(Math.pow(this.actorToMeet.dx,2)+Math.pow(this.actorToMeet.dy,2));n==0||this._speedWasSpecified||(this.speed=n);this.current.x=this.actor.x;this.current.y=this.actor.y;this.end.x=this.actorToMeet.x;this.end.y=this.actorToMeet.y;this.distanceBetween=this.current.distance(this.end);this.dir=this.end.minus(this.current).normalize();t=this.dir.scale(this.speed);this.actor.dx=t.x;this.actor.dy=t.y;this.isComplete(this.actor)&&(this.actor.x=this.end.x,this.actor.y=this.end.y,this.actor.dy=0,this.actor.dx=0)},t.prototype.isComplete=function(){return this._stopped||this.distanceBetween<=1},t.prototype.stop=function(){this.actor.dy=0;this.actor.dx=0;this._stopped=!0},t.prototype.reset=function(){this._started=!1},t}();t.Meet=e;o=function(){function n(n,t,i){this._started=!1;this._stopped=!1;this.actor=n;this.end=t;this.speed=i}return n.prototype.update=function(){this._started||(this._started=!0,this.start=this.actor.rotation,this.distance=Math.abs(this.end-this.start));this.actor.rx=this.speed;this.isComplete(this.actor)&&(this.actor.rotation=this.end,this.actor.rx=0)},n.prototype.isComplete=function(){return this._stopped||Math.abs(this.actor.rotation-this.start)>=this.distance},n.prototype.stop=function(){this.actor.rx=0;this._stopped=!0},n.prototype.reset=function(){this._started=!1},n}();t.RotateTo=o;s=function(){function n(n,t,i){this._started=!1;this._stopped=!1;this.actor=n;this.end=t;this.time=i;this.speed=(this.end-this.actor.rotation)/i*1e3}return n.prototype.update=function(){this._started||(this._started=!0,this.start=this.actor.rotation,this.distance=Math.abs(this.end-this.start));this.actor.rx=this.speed;this.isComplete(this.actor)&&(this.actor.rotation=this.end,this.actor.rx=0)},n.prototype.isComplete=function(){return this._stopped||Math.abs(this.actor.rotation-this.start)>=this.distance},n.prototype.stop=function(){this.actor.rx=0;this._stopped=!0},n.prototype.reset=function(){this._started=!1},n}();t.RotateBy=s;h=function(){function n(n,t,i,r,u){this._started=!1;this._stopped=!1;this.actor=n;this.endX=t;this.endY=i;this.speedX=r;this.speedY=u}return n.prototype.update=function(){var n,t;this._started||(this._started=!0,this.startX=this.actor.scale.x,this.startY=this.actor.scale.y,this.distanceX=Math.abs(this.endX-this.startX),this.distanceY=Math.abs(this.endY-this.startY));Math.abs(this.actor.scale.x-this.startX)>=this.distanceX?this.actor.sx=0:(n=this.endY<this.startY?-1:1,this.actor.sx=this.speedX*n);Math.abs(this.actor.scale.y-this.startY)>=this.distanceY?this.actor.sy=0:(t=this.endY<this.startY?-1:1,this.actor.sy=this.speedY*t);this.isComplete(this.actor)&&(this.actor.scale.x=this.endX,this.actor.scale.y=this.endY,this.actor.sx=0,this.actor.sy=0)},n.prototype.isComplete=function(){return this._stopped||Math.abs(this.actor.scale.y-this.startX)>=this.distanceX&&Math.abs(this.actor.scale.y-this.startY)>=this.distanceY},n.prototype.stop=function(){this.actor.sx=0;this.actor.sy=0;this._stopped=!0},n.prototype.reset=function(){this._started=!1},n}();t.ScaleTo=h;c=function(){function n(n,t,i,r){this._started=!1;this._stopped=!1;this.actor=n;this.endX=t;this.endY=i;this.time=r;this.speedX=(this.endX-this.actor.scale.x)/r*1e3;this.speedY=(this.endY-this.actor.scale.y)/r*1e3}return n.prototype.update=function(){this._started||(this._started=!0,this.startX=this.actor.scale.x,this.startY=this.actor.scale.y,this.distanceX=Math.abs(this.endX-this.startX),this.distanceY=Math.abs(this.endY-this.startY));var n=this.endX<this.startX?-1:1,t=this.endY<this.startY?-1:1;this.actor.sx=this.speedX*n;this.actor.sy=this.speedY*t;this.isComplete(this.actor)&&(this.actor.scale.x=this.endX,this.actor.scale.y=this.endY,this.actor.sx=0,this.actor.sy=0)},n.prototype.isComplete=function(){return this._stopped||Math.abs(this.actor.scale.x-this.startX)>=this.distanceX&&Math.abs(this.actor.scale.y-this.startY)>=this.distanceY},n.prototype.stop=function(){this.actor.sx=0;this.actor.sy=0;this._stopped=!0},n.prototype.reset=function(){this._started=!1},n}();t.ScaleBy=c;l=function(){function n(n,t){this.elapsedTime=0;this._started=!1;this._stopped=!1;this.actor=n;this.delay=t}return n.prototype.update=function(n){this._started||(this._started=!0);this.x=this.actor.x;this.y=this.actor.y;this.elapsedTime+=n},n.prototype.isComplete=function(){return this._stopped||this.elapsedTime>=this.delay},n.prototype.stop=function(){this._stopped=!0},n.prototype.reset=function(){this.elapsedTime=0;this._started=!1},n}();t.Delay=l;a=function(){function n(n,t,i,r){r===void 0&&(r=1);this.timeVisible=0;this.timeNotVisible=0;this.elapsedTime=0;this.totalTime=0;this._stopped=!1;this._started=!1;this.actor=n;this.timeVisible=t;this.timeNotVisible=i;this.duration=(t+i)*r}return n.prototype.update=function(n){this._started||(this._started=!0);this.elapsedTime+=n;this.totalTime+=n;this.actor.visible&&this.elapsedTime>=this.timeVisible&&(this.actor.visible=!1,this.elapsedTime=0);!this.actor.visible&&this.elapsedTime>=this.timeNotVisible&&(this.actor.visible=!0,this.elapsedTime=0);this.isComplete(this.actor)&&(this.actor.visible=!0)},n.prototype.isComplete=function(){return this._stopped||this.totalTime>=this.duration},n.prototype.stop=function(){this.actor.visible=!0;this._stopped=!0},n.prototype.reset=function(){this._started=!1;this.elapsedTime=0;this.totalTime=0},n}();t.Blink=a;v=function(){function t(n,t,i){this.multiplyer=1;this._started=!1;this._stopped=!1;this.actor=n;this.endOpacity=t;this.speed=i;t<n.opacity&&(this.multiplyer=-1)}return t.prototype.update=function(t){this._started||(this._started=!0);this.speed>0&&(this.actor.opacity+=this.multiplyer*Math.abs(this.actor.opacity-this.endOpacity)*t/this.speed);this.speed-=t;n.Logger.getInstance().debug("actor opacity: "+this.actor.opacity);this.isComplete(this.actor)&&(this.actor.opacity=this.endOpacity)},t.prototype.isComplete=function(){return this._stopped||Math.abs(this.actor.opacity-this.endOpacity)<.05},t.prototype.stop=function(){this._stopped=!0},t.prototype.reset=function(){this._started=!1},t}();t.Fade=v;y=function(){function n(n){this._started=!1;this._stopped=!1;this.actor=n}return n.prototype.update=function(){this.actor.actionQueue.clearActions();this.actor.kill();this._stopped=!0},n.prototype.isComplete=function(){return this._stopped},n.prototype.stop=function(){},n.prototype.reset=function(){},n}();t.Die=y;p=function(){function n(n,t){this._method=null;this._actor=null;this._hasBeenCalled=!1;this._actor=n;this._method=t}return n.prototype.update=function(){this._method.call(this._actor);this._hasBeenCalled=!0},n.prototype.isComplete=function(){return this._hasBeenCalled},n.prototype.reset=function(){this._hasBeenCalled=!1},n.prototype.stop=function(){this._hasBeenCalled=!0},n}();t.CallMethod=p;w=function(){function n(n,t,r){var u=this;this._stopped=!1;this.actor=n;this.actionQueue=new i(n);this.repeat=t;this.originalRepeat=t;r.forEach(function(n){n.reset();u.actionQueue.add(n)})}return n.prototype.update=function(n){this.x=this.actor.x;this.y=this.actor.y;this.actionQueue.hasNext()||(this.actionQueue.reset(),this.repeat--);this.actionQueue.update(n)},n.prototype.isComplete=function(){return this._stopped||this.repeat<=0},n.prototype.stop=function(){this._stopped=!0},n.prototype.reset=function(){this.repeat=this.originalRepeat},n}();t.Repeat=w;b=function(){function n(n,t){var r=this;this._stopped=!1;this.actor=n;this.actionQueue=new i(n);t.forEach(function(n){n.reset();r.actionQueue.add(n)})}return n.prototype.update=function(n){(this.x=this.actor.x,this.y=this.actor.y,this._stopped)||(this.actionQueue.hasNext()||this.actionQueue.reset(),this.actionQueue.update(n))},n.prototype.isComplete=function(){return this._stopped},n.prototype.stop=function(){this._stopped=!0;this.actionQueue.clearActions()},n.prototype.reset=function(){},n}();t.RepeatForever=b;i=function(){function n(n){this._actions=[];this._completedActions=[];this.actor=n}return n.prototype.add=function(n){this._actions.push(n)},n.prototype.remove=function(n){var t=this._actions.indexOf(n);this._actions.splice(t,1)},n.prototype.clearActions=function(){this._actions.length=0;this._completedActions.length=0;this._currentAction.stop()},n.prototype.getActions=function(){return this._actions.concat(this._completedActions)},n.prototype.hasNext=function(){return this._actions.length>0},n.prototype.reset=function(){this._actions=this.getActions();this._actions.forEach(function(n){n.reset()});this._completedActions=[]},n.prototype.update=function(n){this._actions.length>0&&(this._currentAction=this._actions[0],this._currentAction.update(n),this._currentAction.isComplete(this.actor)&&this._completedActions.push(this._actions.shift()))},n}();t.ActionQueue=i})(i=t.Actions||(t.Actions={}))})(t=n.Internal||(n.Internal={}))}(ex||(ex={})),function(n){var t=function(){function t(){this._actors=[];this._queues=[];arguments!==null&&(this._actors=Array.prototype.slice.call(arguments,0),this._queues=this._actors.map(function(n){return n.actionQueue}))}return t.prototype.clearActions=function(){this._queues.forEach(function(n){return n.clearActions()})},t.prototype.addActorToContext=function(n){this._actors.push(n);this._queues.push(n.actionQueue)},t.prototype.removeActorFromContext=function(n){var t=this._actors.indexOf(n);t>-1&&(this._actors.splice(t,1),this._queues.splice(t,1))},t.prototype.moveTo=function(t,i,r){var u=this;return this._queues.forEach(function(f,e){f.add(new n.Internal.Actions.MoveTo(u._actors[e],t,i,r))}),this},t.prototype.moveBy=function(t,i,r){var u=this;return this._queues.forEach(function(f,e){f.add(new n.Internal.Actions.MoveBy(u._actors[e],t,i,r))}),this},t.prototype.rotateTo=function(t,i){var r=this;return this._queues.forEach(function(u,f){u.add(new n.Internal.Actions.RotateTo(r._actors[f],t,i))}),this},t.prototype.rotateBy=function(t,i){var r=this;return this._queues.forEach(function(u,f){u.add(new n.Internal.Actions.RotateBy(r._actors[f],t,i))}),this},t.prototype.scaleTo=function(t,i,r,u){var f=this;return this._queues.forEach(function(e,o){e.add(new n.Internal.Actions.ScaleTo(f._actors[o],t,i,r,u))}),this},t.prototype.scaleBy=function(t,i,r){var u=this;return this._queues.forEach(function(f,e){f.add(new n.Internal.Actions.ScaleBy(u._actors[e],t,i,r))}),this},t.prototype.blink=function(t,i,r){var u=this;return r===void 0&&(r=1),this._queues.forEach(function(f,e){f.add(new n.Internal.Actions.Blink(u._actors[e],t,i,r))}),this},t.prototype.fade=function(t,i){var r=this;return this._queues.forEach(function(u,f){u.add(new n.Internal.Actions.Fade(r._actors[f],t,i))}),this},t.prototype.delay=function(t){var i=this;return this._queues.forEach(function(r,u){r.add(new n.Internal.Actions.Delay(i._actors[u],t))}),this},t.prototype.die=function(){var t=this;return this._queues.forEach(function(i,r){i.add(new n.Internal.Actions.Die(t._actors[r]))}),this},t.prototype.callMethod=function(t){var i=this;return this._queues.forEach(function(r,u){r.add(new n.Internal.Actions.CallMethod(i._actors[u],t))}),this},t.prototype.repeat=function(t){var i=this;return t?(this._queues.forEach(function(r,u){r.add(new n.Internal.Actions.Repeat(i._actors[u],t,i._actors[u].actionQueue.getActions()))}),this):(this.repeatForever(),this)},t.prototype.repeatForever=function(){var t=this;return this._queues.forEach(function(i,r){i.add(new n.Internal.Actions.RepeatForever(t._actors[r],t._actors[r].actionQueue.getActions()))}),this},t.prototype.follow=function(t,i){var r=this;return this._queues.forEach(function(u,f){i==undefined?u.add(new n.Internal.Actions.Follow(r._actors[f],t)):u.add(new n.Internal.Actions.Follow(r._actors[f],t,i))}),this},t.prototype.meet=function(t,i){var r=this;return this._queues.forEach(function(u,f){i==undefined?u.add(new n.Internal.Actions.Meet(r._actors[f],t)):u.add(new n.Internal.Actions.Meet(r._actors[f],t,i))}),this},t.prototype.asPromise=function(){var t=this,i=this._queues.map(function(i,r){var u=new n.Promise;return i.add(new n.Internal.Actions.CallMethod(t._actors[r],function(){u.resolve()})),u});return n.Promise.join.apply(this,i)},t}();n.ActionContext=t}(ex||(ex={})),function(n){var t=function(t){function i(i,r){if(t.call(this),this.name=i,this.scene=r,this._logger=n.Logger.getInstance(),this._members=[],this.actions=new n.ActionContext,r==null)this._logger.error("Invalid constructor arguments passed to Group: ",i,", scene must not be null!");else{var u=r.groups[i];u&&this._logger.warn("Group with name",i,"already exists. This new group will replace it.");r.groups[i]=this}}return __extends(i,t),i.prototype.add=function(t){var i=this;t instanceof n.Actor&&(t=[].concat(t));t.forEach(function(n){var t=i.getMembers().indexOf(n);t===-1&&(i._members.push(n),i.scene.add(n),i.actions.addActorToContext(n),i.eventDispatcher.wire(n.eventDispatcher))})},i.prototype.remove=function(n){var t=this._members.indexOf(n);t>-1&&(this._members.splice(t,1),this.actions.removeActorFromContext(n),this.eventDispatcher.unwire(n.eventDispatcher))},i.prototype.move=function(t){if(arguments.length===1&&t instanceof n.Vector)this.getMembers().forEach(function(n){n.x+=t.x;n.y+=t.y});else if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var i=arguments[0],r=arguments[1];this.getMembers().forEach(function(n){n.x+=i;n.y+=r})}else this._logger.error("Invalid arguments passed to group move",this.name,"args:",arguments)},i.prototype.rotate=function(){if(typeof arguments[0]=="number"){var n=arguments[0];this.getMembers().forEach(function(t){t.rotation+=n})}else this._logger.error("Invalid arguments passed to group rotate",this.name,"args:",arguments)},i.prototype.on=function(n,t){this.eventDispatcher.subscribe(n,t)},i.prototype.off=function(n,t){this.eventDispatcher.unsubscribe(n,t)},i.prototype.emit=function(n,t){this.eventDispatcher.emit(n,t)},i.prototype.contains=function(n){return this.getMembers().indexOf(n)>-1},i.prototype.getMembers=function(){return this._members},i.prototype.getRandomMember=function(){return this._members[Math.floor(Math.random()*this._members.length)]},i.prototype.getBounds=function(){return this.getMembers().map(function(n){return n.getBounds()}).reduce(function(n,t){return n.combine(t)})},i}(n.Class);n.Group=t}(ex||(ex={})),function(n){var t=function(t){function i(i){t.call(this);this.children=[];this.tileMaps=[];this.groups={};this.uiActors=[];this.isInitialized=!1;this._collisionResolver=new n.DynamicTreeCollisionResolver;this._killQueue=[];this._timers=[];this._cancelQueue=[];this._logger=n.Logger.getInstance();this.camera=new n.BaseCamera;i&&this.camera.setFocus(i.width/2,i.height/2)}return __extends(i,t),i.prototype.onInitialize=function(n){this._logger.debug("Scene.onInitialize",this,n)},i.prototype.onActivate=function(){this._logger.debug("Scene.onActivate",this)},i.prototype.onDeactivate=function(){this._logger.debug("Scene.onDeactivate",this)},i.prototype.publish=function(n,t){this.children.forEach(function(i){i.triggerEvent(n,t)})},i.prototype.update=function(n,t){var u,f,i,r,e;for(this.uiActors.forEach(function(i){i.update(n,t)}),this.tileMaps.forEach(function(i){i.update(n,t)}),r=0,i=0,r=this.children.length;i<r;i++)this.children[i].update(n,t);for(this._collisionResolver&&(this._collisionResolver.update(this.children),this._collisionResolver.evaluate(this.children)),u=0,i=0,r=this._killQueue.length;i<r;i++)u=this.children.indexOf(this._killQueue[i]),u>-1&&this.children.splice(u,1);for(this._killQueue.length=0,f=0,i=0,r=this._cancelQueue.length;i<r;i++)this.removeTimer(this._cancelQueue[i]);this._cancelQueue.length=0;e=this;this._timers=this._timers.filter(function(n){return n.update(t),!n.complete})},i.prototype.draw=function(n,t){var i,r;n.save();this.camera&&this.camera.update(n,t);this.tileMaps.forEach(function(i){i.draw(n,t)});var r=0,u;for(i=0,r=this.children.length;i<r;i++)u=this.children[i],u.visible&&this.children[i].draw(n,t);this.engine&&this.engine.isDebug&&(n.strokeStyle="yellow",this.debugDraw(n));n.restore();this.uiActors.forEach(function(i){i.visible&&i.draw(n,t)});this.engine&&this.engine.isDebug&&this.uiActors.forEach(function(t){t.debugDraw(n)})},i.prototype.debugDraw=function(n){this.tileMaps.forEach(function(t){t.debugDraw(n)});this.children.forEach(function(t){t.debugDraw(n)})},i.prototype.contains=function(n){return this.children.indexOf(n)>-1},i.prototype.add=function(t){if(t instanceof n.UIActor){this.addUIActor(t);return}t instanceof n.Actor&&this.addChild(t);t instanceof n.Timer&&this.addTimer(t);t instanceof n.TileMap&&this.addTileMap(t)},i.prototype.remove=function(t){if(t instanceof n.UIActor){this.removeUIActor(t);return}t instanceof n.Actor&&(this._collisionResolver.remove(t),this.removeChild(t));t instanceof n.Timer&&this.removeTimer(t);t instanceof n.TileMap&&this.removeTileMap(t)},i.prototype.addUIActor=function(n){this.uiActors.push(n);n.scene=this},i.prototype.removeUIActor=function(n){var t=this.uiActors.indexOf(n);t>-1&&this.uiActors.splice(t,1)},i.prototype.addChild=function(n){this._collisionResolver.register(n);n.scene=this;this.children.push(n);n.parent=this.actor},i.prototype.addTileMap=function(n){this.tileMaps.push(n)},i.prototype.removeTileMap=function(n){var t=this.tileMaps.indexOf(n);t>-1&&this.tileMaps.splice(t,1)},i.prototype.removeChild=function(n){this._collisionResolver.remove(n);this._killQueue.push(n);n.parent=null},i.prototype.addTimer=function(n){return this._timers.push(n),n.scene=this,n},i.prototype.removeTimer=function(n){var t=this._timers.indexOf(n);return t!==-1&&this._timers.splice(t,1),n},i.prototype.cancelTimer=function(n){return this._cancelQueue.push(n),n},i.prototype.isTimerActive=function(n){return this._timers.indexOf(n)>-1},i.prototype.createGroup=function(t){return new n.Group(t,this)},i.prototype.getGroup=function(n){return this.groups[n]},i.prototype.removeGroup=function(t){typeof t=="string"?delete this.groups[t]:t instanceof n.Group?delete this.groups[t.name]:this._logger.error("Invalid arguments to removeGroup",t)},i}(n.Class);n.Scene=t}(ex||(ex={})),function(n){var t=function(){function n(){}return n.Linear=function(n,t,i,r){return i=i-t,i*n/r+t},n.EaseInQuad=function(n,t,i,r){return n/=r,i*n*n+t},n.EaseOutQuad=function(n,t,i,r){return n/=r,-i*n*(n-2)+t},n.EaseInOutQuad=function(n,t,i,r){return(i=i-t,n/=r/2,n<1)?i/2*n*n+t:(n--,-i/2*(n*(n-2)-1)+t)},n.EaseInCubic=function(n,t,i,r){return i=i-t,n/=r,i*n*n*n+t},n.EaseOutCubic=function(n,t,i,r){return i=i-t,n/=r,i*(n*n*n+1)+t},n.EaseInOutCubic=function(n,t,i,r){return(i=i-t,n/=r/2,n<1)?i/2*n*n*n+t:(n-=2,i/2*(n*n*n+2)+t)},n}();n.EasingFunctions=t}(ex||(ex={})),function(n){(function(n){n[n.PreventCollision=0]="PreventCollision";n[n.Passive=1]="Passive";n[n.Active=2]="Active";n[n.Elastic=3]="Elastic";n[n.Fixed=4]="Fixed"})(n.CollisionType||(n.CollisionType={}));var i=n.CollisionType,t=function(t){function i(r,u,f,e,o){t.call(this);this.id=i.maxId++;this.x=0;this.y=0;this.height=0;this.width=0;this.rotation=0;this.rx=0;this.scale=new n.Vector(1,1);this.sx=0;this.sy=0;this.dx=0;this.dy=0;this.ax=0;this.ay=0;this.isOffScreen=!1;this.visible=!0;this.opacity=1;this.previousOpacity=1;this.actions=new n.ActionContext(this);this.logger=n.Logger.getInstance();this.scene=null;this.parent=null;this.children=[];this.collisionType=0;this.collisionGroups=[];this._collisionHandlers={};this._isInitialized=!1;this.frames={};this.currentDrawing=null;this.centerDrawingX=!0;this.centerDrawingY=!0;this.pipeline=[];this.enableCapturePointer=!1;this.capturePointer={captureMoveEvents:!1};this._isKilled=!1;this.x=r||0;this.y=u||0;this.width=f||0;this.height=e||0;o&&(this.color=o.clone(),this.opacity=o.a);this.pipeline.push(new n.MovementModule);this.pipeline.push(new n.OffscreenCullingModule);this.pipeline.push(new n.CapturePointerModule);this.actionQueue=new n.Internal.Actions.ActionQueue(this);this.anchor=new n.Point(.5,.5)}return __extends(i,t),i.prototype.onInitialize=function(){},i.prototype._checkForPointerOptIn=function(n){n&&(n.toLowerCase()==="pointerdown"||n.toLowerCase()==="pointerdown"||n.toLowerCase()==="pointermove")&&(this.enableCapturePointer=!0,n.toLowerCase()==="pointermove"&&(this.capturePointer.captureMoveEvents=!0))},i.prototype.addEventListener=function(n,i){this._checkForPointerOptIn(n);t.prototype.addEventListener.call(this,n,i)},i.prototype.on=function(n,t){this._checkForPointerOptIn(n);this.eventDispatcher.subscribe(n,t)},i.prototype.kill=function(){this.scene?(this.scene.remove(this),this._isKilled=!0):this.logger.warn("Cannot kill actor, it was never added to the Scene")},i.prototype.isKilled=function(){return this._isKilled},i.prototype.addChild=function(t){t.collisionType=0;n.Util.addItemToArray(t,this.children)&&(t.parent=this)},i.prototype.removeChild=function(t){n.Util.removeItemToArray(t,this.children)&&(t.parent=null)},i.prototype.setDrawing=function(n){n=n.toString();this.currentDrawing!=this.frames[n]&&this.frames[n].reset();this.currentDrawing=this.frames[n]},i.prototype.addDrawing=function(){arguments.length===2?(this.frames[arguments[0]]=arguments[1],this.currentDrawing||(this.currentDrawing=arguments[1])):(arguments[0]instanceof n.Sprite&&this.addDrawing("default",arguments[0]),arguments[0]instanceof n.Texture&&this.addDrawing("default",arguments[0].asSprite()))},i.prototype.triggerEvent=function(n,t){this.eventDispatcher.publish(n,t)},i.prototype.addCollisionGroup=function(n){this.collisionGroups.push(n)},i.prototype.removeCollisionGroup=function(n){var t=this.collisionGroups.indexOf(n);t!==-1&&this.collisionGroups.splice(t,1)},i.prototype.getCenter=function(){var t=this._getCalculatedAnchor();return new n.Vector(this.x+this.getWidth()/2,this.y+this.getHeight()/2)},i.prototype.getWidth=function(){return this.width*this.scale.x},i.prototype.setWidth=function(n){this.width=n/this.scale.x},i.prototype.getHeight=function(){return this.height*this.scale.y},i.prototype.setHeight=function(n){this.height=n/this.scale.y},i.prototype.setCenterDrawing=function(n){this.centerDrawingY=n;this.centerDrawingX=n},i.prototype.getLeft=function(){return this.x},i.prototype.getRight=function(){return this.x+this.getWidth()},i.prototype.getTop=function(){return this.y},i.prototype.getBottom=function(){return this.y+this.getHeight()},i.prototype.getWorldX=function(){return this.parent?this.x*this.parent.scale.x+this.parent.getWorldX():this.x},i.prototype.getWorldY=function(){return this.parent?this.y*this.parent.scale.y+this.parent.getWorldY():this.y},i.prototype.getGlobalScale=function(){if(!this.parent)return new n.Point(this.scale.x,this.scale.y);var t=this.parent.getGlobalScale();return new n.Point(this.scale.x*t.x,this.scale.y*t.y)},i.prototype.getBounds=function(){var t=this._getCalculatedAnchor();return new n.BoundingBox(this.getWorldX()-t.x,this.getWorldY()-t.y,this.getWorldX()+this.getWidth()-t.x,this.getWorldY()+this.getHeight()-t.y)},i.prototype.contains=function(t,i){return this.getBounds().contains(new n.Point(t,i))},i.prototype.getSideFromIntersect=function(n){return n?Math.abs(n.x)>Math.abs(n.y)?n.x<0?4:3:n.y<0?2:1:0},i.prototype.collidesWithSide=function(n){var t=this.collides(n);return t?Math.abs(t.x)>Math.abs(t.y)?this.x<n.x?4:3:this.y<n.y?2:1:0},i.prototype.collides=function(n){var t=this.getBounds(),i=n.getBounds();return t.collides(i)},i.prototype.onCollidesWith=function(n,t){this._collisionHandlers[n]||(this._collisionHandlers[n]=[]);this._collisionHandlers[n].push(t)},i.prototype.getCollisionHandlers=function(){return this._collisionHandlers},i.prototype.removeCollidesWith=function(n){this._collisionHandlers[n]=[]},i.prototype.within=function(n,t){return Math.sqrt(Math.pow(this.x-n.x,2)+Math.pow(this.y-n.y,2))<=t},i.prototype.clearActions=function(){this.actionQueue.clearActions()},i.prototype.easeTo=function(t,i,r,u){return u===void 0&&(u=n.EasingFunctions.Linear),this.actionQueue.add(new n.Internal.Actions.EaseTo(this,t,i,r,u)),this},i.prototype.moveTo=function(t,i,r){return this.actionQueue.add(new n.Internal.Actions.MoveTo(this,t,i,r)),this},i.prototype.moveBy=function(t,i,r){return this.actionQueue.add(new n.Internal.Actions.MoveBy(this,t,i,r)),this},i.prototype.rotateTo=function(t,i){return this.actionQueue.add(new n.Internal.Actions.RotateTo(this,t,i)),this},i.prototype.rotateBy=function(t,i){return this.actionQueue.add(new n.Internal.Actions.RotateBy(this,t,i)),this},i.prototype.scaleTo=function(t,i,r,u){return this.actionQueue.add(new n.Internal.Actions.ScaleTo(this,t,i,r,u)),this},i.prototype.scaleBy=function(t,i,r){return this.actionQueue.add(new n.Internal.Actions.ScaleBy(this,t,i,r)),this},i.prototype.blink=function(t,i,r){return r===void 0&&(r=1),this.actionQueue.add(new n.Internal.Actions.Blink(this,t,i,r)),this},i.prototype.fade=function(t,i){return this.actionQueue.add(new n.Internal.Actions.Fade(this,t,i)),this},i.prototype.delay=function(t){return this.actionQueue.add(new n.Internal.Actions.Delay(this,t)),this},i.prototype.die=function(){return this.actionQueue.add(new n.Internal.Actions.Die(this)),this},i.prototype.callMethod=function(t){return this.actionQueue.add(new n.Internal.Actions.CallMethod(this,t)),this},i.prototype.repeat=function(t){return t?(this.actionQueue.add(new n.Internal.Actions.Repeat(this,t,this.actionQueue.getActions())),this):(this.repeatForever(),this)},i.prototype.repeatForever=function(){return this.actionQueue.add(new n.Internal.Actions.RepeatForever(this,this.actionQueue.getActions())),this},i.prototype.follow=function(t,i){return i==undefined?this.actionQueue.add(new n.Internal.Actions.Follow(this,t)):this.actionQueue.add(new n.Internal.Actions.Follow(this,t,i)),this},i.prototype.meet=function(t,i){return i==undefined?this.actionQueue.add(new n.Internal.Actions.Meet(this,t)):this.actionQueue.add(new n.Internal.Actions.Meet(this,t,i)),this},i.prototype.asPromise=function(){var t=new n.Promise;return this.callMethod(function(){t.resolve()}),t},i.prototype._getCalculatedAnchor=function(){return new n.Point(this.getWidth()*this.anchor.x,this.getHeight()*this.anchor.y)},i.prototype.update=function(t,i){var u,r;if(!this._isInitialized){this.onInitialize(t);this.eventDispatcher.publish("initialize",new n.InitializeEvent(t));this._isInitialized=!0}for(u=this.eventDispatcher,this.actionQueue.update(i),r=0;r<this.pipeline.length;r++)this.pipeline[r].update(this,t,i);u.publish(n.EventType[5],new n.UpdateEvent(i))},i.prototype.draw=function(t,i){var r,o,f,e,u;if(!this.isOffScreen){if(r=this._getCalculatedAnchor(),t.save(),t.scale(this.scale.x,this.scale.y),t.translate(this.x,this.y),t.rotate(this.rotation),this.previousOpacity!=this.opacity){for(o in this.frames)this.frames[o].addEffect(new n.Effects.Opacity(this.opacity));this.previousOpacity=this.opacity}for(this.currentDrawing?(f=0,e=0,this.centerDrawingX&&(f=(this.currentDrawing.width*this.currentDrawing.scale.x-this.getWidth())/2-this.currentDrawing.width*this.currentDrawing.scale.x*this.currentDrawing.anchor.x),this.centerDrawingY&&(e=(this.currentDrawing.height*this.currentDrawing.scale.y-this.getHeight())/2-this.currentDrawing.height*this.currentDrawing.scale.y*this.currentDrawing.anchor.y),this.currentDrawing.draw(t,-r.x-f,-r.y-e)):this.color&&(t.fillStyle=this.color.toString(),t.fillRect(-r.x,-r.y,this.width,this.height)),u=0;u<this.children.length;u++)this.children[u].draw(t,i);t.restore()}},i.prototype.debugDraw=function(t){var r=this.getBounds(),i;for(r.debugDraw(t),t.fillText("id: "+this.id,r.left+3,r.top+10),t.fillStyle=n.Color.Yellow.toString(),t.beginPath(),t.arc(this.getWorldX(),this.getWorldY(),3,0,Math.PI*2),t.closePath(),t.fill(),t.save(),t.translate(this.x,this.y),t.rotate(this.rotation),i=0;i<this.children.length;i++)this.children[i].debugDraw(t);t.restore()},i.maxId=0,i}(n.Class);n.Actor=t}(ex||(ex={})),function(n){var t,r,i,u;(function(n){n[n.Debug=0]="Debug";n[n.Info=1]="Info";n[n.Warn=2]="Warn";n[n.Error=3]="Error";n[n.Fatal=4]="Fatal"})(n.LogLevel||(n.LogLevel={}));t=n.LogLevel;r=function(){function n(){if(this.appenders=[],this.defaultLevel=1,n._instance)throw new Error("Logger is a singleton");return n._instance=this,n._instance.addAppender(new i),n._instance}return n.getInstance=function(){return n._instance==null&&(n._instance=new n),n._instance},n.prototype.addAppender=function(n){this.appenders.push(n)},n.prototype.clearAppenders=function(){this.appenders.length=0},n.prototype._log=function(n,t){var i=this;n==null&&(n=this.defaultLevel);this.appenders.forEach(function(r){n>=i.defaultLevel&&r.log(n,t)})},n.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];this._log(0,t)},n.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];this._log(1,t)},n.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];this._log(2,t)},n.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];this._log(3,t)},n.prototype.fatal=function(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];this._log(4,t)},n._instance=null,n}();n.Logger=r;i=function(){function n(){}return n.prototype.log=function(n,i){if(console||console.log||!console.warn||!console.error){var r=[];r.unshift.apply(r,i);r.unshift("["+t[n]+"] : ");n<2?console.log.apply?console.log.apply(console,r):console.log(r.join(" ")):n<3?console.warn.apply?console.warn.apply(console,r):console.warn(r.join(" ")):console.error.apply?console.error.apply(console,r):console.error(r.join(" "))}},n}();n.ConsoleAppender=i;u=function(){function n(n,t){this._messages=[];this.canvas=document.createElement("canvas");this.canvas.width=n||window.innerWidth;this.canvas.height=t||window.innerHeight;this.canvas.style.position="absolute";this.ctx=this.canvas.getContext("2d");document.body.appendChild(this.canvas)}return n.prototype.log=function(n,i){var e=i.join(","),f,r,u;for(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this._messages.unshift("["+t[n]+"] : "+e),f=10,r=1,u=0;u<this._messages.length;u++)this.ctx.fillStyle="rgba(255,255,255,"+r.toFixed(2)+")",this.ctx.fillText(this._messages[u],200,f),f+=10,r=r>0?r-.05:0},n}();n.ScreenAppender=u}(ex||(ex={})),function(n){var v,t,i,r,u,f,e,o,s,h,c,l,a;(function(n){n[n.Collision=0]="Collision";n[n.EnterViewPort=1]="EnterViewPort";n[n.ExitViewPort=2]="ExitViewPort";n[n.Blur=3]="Blur";n[n.Focus=4]="Focus";n[n.Update=5]="Update";n[n.Activate=6]="Activate";n[n.Deactivate=7]="Deactivate";n[n.Initialize=8]="Initialize"})(n.EventType||(n.EventType={}));v=n.EventType;t=function(){function n(){}return n}();n.GameEvent=t;i=function(n){function t(t,i){n.call(this);this.topic=t;this.handler=i}return __extends(t,n),t}(t);n.SubscribeEvent=i;r=function(n){function t(t,i){n.call(this);this.topic=t;this.handler=i}return __extends(t,n),t}(t);n.UnsubscribeEvent=r;u=function(n){function t(){n.call(this)}return __extends(t,n),t}(t);n.VisibleEvent=u;f=function(n){function t(){n.call(this)}return __extends(t,n),t}(t);n.HiddenEvent=f;e=function(n){function t(t,i,r,u){n.call(this);this.actor=t;this.other=i;this.side=r;this.intersection=u}return __extends(t,n),t}(t);n.CollisionEvent=e;o=function(n){function t(t){n.call(this);this.delta=t}return __extends(t,n),t}(t);n.UpdateEvent=o;s=function(n){function t(t){n.call(this);this.engine=t}return __extends(t,n),t}(t);n.InitializeEvent=s;h=function(n){function t(t){n.call(this);this.oldScene=t}return __extends(t,n),t}(t);n.ActivateEvent=h;c=function(n){function t(t){n.call(this);this.newScene=t}return __extends(t,n),t}(t);n.DeactivateEvent=c;l=function(n){function t(){n.call(this)}return __extends(t,n),t}(t);n.ExitViewPortEvent=l;a=function(n){function t(){n.call(this)}return __extends(t,n),t}(t);n.EnterViewPortEvent=a}(ex||(ex={})),function(n){var t=function(){function t(t){this._handlers={};this._wiredEventDispatchers=[];this._log=n.Logger.getInstance();this._target=t}return t.prototype.publish=function(t,i){if(t){t=t.toLowerCase();var r=this._target;i||(i=new n.GameEvent);i.target=r;this._handlers[t]&&this._handlers[t].forEach(function(n){n.call(r,i)});this._wiredEventDispatchers.forEach(function(n){return n.publish(t,i)})}},t.prototype.emit=function(n,t){this.publish(n,t)},t.prototype.subscribe=function(t,i){t=t.toLowerCase();this._handlers[t]||(this._handlers[t]=[]);this._handlers[t].push(i);t!=="unsubscribe"&&t!=="subscribe"&&this.emit("subscribe",new n.SubscribeEvent(t,i))},t.prototype.unsubscribe=function(t,i){var r,u;t=t.toLowerCase();r=this._handlers[t];r&&(i?(u=r.indexOf(i),this._handlers[t].splice(u,1)):this._handlers[t].length=0);t!=="unsubscribe"&&t!=="subscribe"&&this.emit("unsubscribe",new n.UnsubscribeEvent(t,i))},t.prototype.wire=function(n){n._wiredEventDispatchers.push(this)},t.prototype.unwire=function(n){var t=n._wiredEventDispatchers.indexOf(this);t>-1&&n._wiredEventDispatchers.splice(t,1)},t}();n.EventDispatcher=t}(ex||(ex={})),function(n){var i=function(){function n(n,t,i,r){this.r=n;this.g=t;this.b=i;this.a=r!=null?r:1}return n.fromRGB=function(t,i,r,u){return new n(t,i,r,u)},n.fromHex=function(t){var i=null;if(i=t.match(/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i)){var u=parseInt(i[1],16),f=parseInt(i[2],16),e=parseInt(i[3],16),r=1;return i[4]&&(r=parseInt(i[4],16)/255),new n(u,f,e,r)}throw new Error("Invalid hex string: "+t);},n.fromHSL=function(n,i,r,u){u===void 0&&(u=1);var f=new t(n,i,r,u);return f.toRGBA()},n.prototype.lighten=function(n){n===void 0&&(n=.1);var i=t.fromRGBA(this.r,this.g,this.b,this.a);return i.l+=i.l*n,i.toRGBA()},n.prototype.darken=function(n){n===void 0&&(n=.1);var i=t.fromRGBA(this.r,this.g,this.b,this.a);return i.l-=i.l*n,i.toRGBA()},n.prototype.saturate=function(n){n===void 0&&(n=.1);var i=t.fromRGBA(this.r,this.g,this.b,this.a);return i.s+=i.s*n,i.toRGBA()},n.prototype.desaturate=function(n){n===void 0&&(n=.1);var i=t.fromRGBA(this.r,this.g,this.b,this.a);return i.s-=i.s*n,i.toRGBA()},n.prototype.mulitiply=function(t){var i=t.r/255*this.r*1,r=t.g/255*this.g*1,u=t.b/255*this.b*1,f=t.a*this.a;return new n(i,r,u,f)},n.prototype.screen=function(n){var t=n.invert(),i=n.invert();return t.mulitiply(i).invert()},n.prototype.invert=function(){return new n(255-this.r,255-this.g,255-this.b,1-this.a)},n.prototype.average=function(t){var i=(t.r+this.r)/2,r=(t.g+this.g)/2,u=(t.b+this.b)/2,f=(t.a+this.a)/2;return new n(i,r,u,f)},n.prototype.toString=function(){var n=String(this.r.toFixed(0))+", "+String(this.g.toFixed(0))+", "+String(this.b.toFixed(0));return this.a!==undefined||this.a!==null?"rgba("+n+", "+String(this.a)+")":"rgb("+n+")"},n.prototype.fillStyle=function(){return this.toString()},n.prototype.clone=function(){return new n(this.r,this.g,this.b,this.a)},n.Black=n.fromHex("#000000"),n.White=n.fromHex("#FFFFFF"),n.Gray=n.fromHex("#808080"),n.LightGray=n.fromHex("#D3D3D3"),n.DarkGray=n.fromHex("#A9A9A9"),n.Yellow=n.fromHex("#FFFF00"),n.Orange=n.fromHex("#FFA500"),n.Red=n.fromHex("#FF0000"),n.Vermillion=n.fromHex("#FF5B31"),n.Rose=n.fromHex("#FF007F"),n.Magenta=n.fromHex("#FF00FF"),n.Violet=n.fromHex("#7F00FF"),n.Blue=n.fromHex("#0000FF"),n.Azure=n.fromHex("#007FFF"),n.Cyan=n.fromHex("#00FFFF"),n.Viridian=n.fromHex("#59978F"),n.Green=n.fromHex("#00FF00"),n.Chartreuse=n.fromHex("#7FFF00"),n.Transparent=n.fromHex("#FFFFFF00"),n}(),t;n.Color=i;t=function(){function n(n,t,i,r){this.h=n;this.s=t;this.l=i;this.a=r}return n.fromRGBA=function(t,i,r,u){var o;t/=255;i/=255;r/=255;var f=Math.max(t,i,r),s=Math.min(t,i,r),e,h,c=(f+s)/2;if(f===s)e=h=0;else{o=f-s;h=c>.5?o/(2-f-s):o/(f+s);switch(f){case t:e=(i-r)/o+(i<r?6:0);break;case i:e=(r-t)/o+2;break;case r:e=(t-i)/o+4}e/=6}return new n(e,h,c,u)},n.prototype.toRGBA=function(){var r,u,f,n,t;if(this.s==0)r=u=f=this.l;else{function e(n,t,i){return(i<0&&(i+=1),i>1&&(i-=1),i<1/6)?n+(t-n)*6*i:i<1/2?t:i<2/3?n+(t-n)*(2/3-i)*6:n}n=this.l<.5?this.l*(1+this.s):this.l+this.s-this.l*this.s;t=2*this.l-n;r=e(t,n,this.h+1/3);u=e(t,n,this.h);f=e(t,n,this.h-1/3)}return new i(r*255,u*255,f*255,this.a)},n}()}(ex||(ex={})),function(n){var t=function(t){function i(i,r,u,f){t.call(this,i,r,u,f);this.pipeline=[];this.pipeline.push(new n.MovementModule);this.pipeline.push(new n.CapturePointerModule);this.anchor.setTo(0,0);this.collisionType=0;this.enableCapturePointer=!0}return __extends(i,t),i.prototype.onInitialize=function(n){this._engine=n},i.prototype.contains=function(i,r,u){if(u===void 0&&(u=!0),u)return t.prototype.contains.call(this,i,r);var f=this._engine.worldToScreenCoordinates(new n.Point(i,r));return t.prototype.contains.call(this,f.x,f.y)},i}(n.Actor);n.UIActor=t}(ex||(ex={})),function(n){var t=function(t){function i(i,r,u,f,e,o){t.call(this,i,r,u,f);this.action=function(){};this.repeats=1;this.target=null;this.repeats=o||this.repeats;this.action=e||this.action;this.collisionType=0;this.eventDispatcher=new n.EventDispatcher(this);this.actionQueue=new n.Internal.Actions.ActionQueue(this)}return __extends(i,t),i.prototype.update=function(n,t){var i,r;if(this.actionQueue.update(t),this.x+=this.dx*t/1e3,this.y+=this.dy*t/1e3,this.rotation+=this.rx*t/1e3,this.scale.x+=this.sx*t/1e3,this.scale.y+=this.sy*t/1e3,this.target)this.collides(this.target)&&this.dispatchAction();else for(i=0;i<n.currentScene.children.length;i++)r=n.currentScene.children[i],r!==this&&r.collisionType!==0&&this.collides(r)&&this.dispatchAction();this.repeats===0&&this.kill()},i.prototype.dispatchAction=function(){this.action.call(this);this.repeats--},i.prototype.draw=function(){return},i.prototype.debugDraw=function(i){t.prototype.debugDraw.call(this,i);i.save();i.translate(this.x,this.y);var r=this.getBounds();r.left=r.left-this.getWorldX();r.right=r.right-this.getWorldX();r.top=r.top-this.getWorldY();r.bottom=r.bottom-this.getWorldY();i.fillStyle=n.Color.Violet.toString();i.strokeStyle=n.Color.Violet.toString();i.fillText("Trigger",10,10);r.debugDraw(i);i.restore()},i}(n.Actor);n.Trigger=t}(ex||(ex={})),function(n){var r,t,i;(function(n){n[n.Circle=0]="Circle";n[n.Rectangle=1]="Rectangle"})(n.EmitterType||(n.EmitterType={}));r=n.EmitterType;t=function(){function t(t,i,r,u,f,e,o,s,h,c){this.position=new n.Vector(0,0);this.velocity=new n.Vector(0,0);this.acceleration=new n.Vector(0,0);this.particleRotationalVelocity=0;this.currentRotation=0;this.focus=null;this.focusAccel=0;this.opacity=1;this.beginColor=n.Color.White.clone();this.endColor=n.Color.White.clone();this.life=300;this.fadeFlag=!1;this.rRate=1;this.gRate=1;this.bRate=1;this.aRate=0;this.currentColor=n.Color.White.clone();this.emitter=null;this.particleSize=5;this.particleSprite=null;this.sizeRate=0;this.elapsedMultiplier=0;this.emitter=t;this.life=i||this.life;this.opacity=r||this.opacity;this.endColor=f||this.endColor.clone();this.beginColor=u||this.beginColor.clone();this.currentColor=this.beginColor.clone();this.position=e||this.position;this.velocity=o||this.velocity;this.acceleration=s||this.acceleration;this.rRate=(this.endColor.r-this.beginColor.r)/this.life;this.gRate=(this.endColor.g-this.beginColor.g)/this.life;this.bRate=(this.endColor.b-this.beginColor.b)/this.life;this.aRate=this.opacity/this.life;this.startSize=h||0;this.endSize=c||0;this.endSize>0&&this.startSize>0&&(this.sizeRate=(this.endSize-this.startSize)/this.life,this.particleSize=this.startSize)}return t.prototype.kill=function(){this.emitter.removeParticle(this)},t.prototype.update=function(t){if(this.life=this.life-t,this.elapsedMultiplier=this.elapsedMultiplier+t,this.life<0&&this.kill(),this.fadeFlag&&(this.opacity=n.Util.clamp(this.aRate*this.life,.0001,1)),this.startSize>0&&this.endSize>0&&(this.particleSize=n.Util.clamp(this.sizeRate*t+this.particleSize,Math.min(this.startSize,this.endSize),Math.max(this.startSize,this.endSize))),this.currentColor.r=n.Util.clamp(this.currentColor.r+this.rRate*t,0,255),this.currentColor.g=n.Util.clamp(this.currentColor.g+this.gRate*t,0,255),this.currentColor.b=n.Util.clamp(this.currentColor.b+this.bRate*t,0,255),this.currentColor.a=n.Util.clamp(this.opacity,.0001,1),this.focus){var i=this.focus.minus(this.position).normalize().scale(this.focusAccel).scale(t/1e3);this.velocity=this.velocity.add(i)}else this.velocity=this.velocity.add(this.acceleration.scale(t/1e3));this.position=this.position.add(this.velocity.scale(t/1e3));this.particleRotationalVelocity&&(this.currentRotation=(this.currentRotation+this.particleRotationalVelocity*t/1e3)%(2*Math.PI))},t.prototype.draw=function(t){if(this.particleSprite){this.particleSprite.rotation=this.currentRotation;this.particleSprite.scale.setTo(this.particleSize,this.particleSize);this.particleSprite.draw(t,this.position.x,this.position.y);return}this.currentColor.a=n.Util.clamp(this.opacity,.0001,1);t.fillStyle=this.currentColor.toString();t.beginPath();t.arc(this.position.x,this.position.y,this.particleSize,0,Math.PI*2);t.fill();t.closePath()},t}();n.Particle=t;i=function(i){function r(t,r,u,f){i.call(this,t,r,u,f,n.Color.White);this._particlesToEmit=0;this.numParticles=0;this.isEmitting=!0;this.particles=null;this.deadParticles=null;this.minVel=0;this.maxVel=0;this.acceleration=new n.Vector(0,0);this.minAngle=0;this.maxAngle=0;this.emitRate=1;this.particleLife=2e3;this.opacity=1;this.fadeFlag=!1;this.focus=null;this.focusAccel=1;this.startSize=null;this.endSize=null;this.minSize=5;this.maxSize=5;this.beginColor=n.Color.White;this.endColor=n.Color.White;this.particleSprite=null;this.emitterType=1;this.radius=0;this.particleRotationalVelocity=0;this.randomRotation=!1;this.collisionType=0;this.particles=new n.Util.Collection;this.deadParticles=new n.Util.Collection}return __extends(r,i),r.prototype.removeParticle=function(n){this.deadParticles.push(n)},r.prototype.emit=function(n){for(var t=0;t<n;t++)this.particles.push(this.createParticle())},r.prototype.clearParticles=function(){this.particles.clear()},r.prototype.createParticle=function(){var u=0,f=0,r=n.Util.randomInRange(this.minAngle,this.maxAngle),o=n.Util.randomInRange(this.minVel,this.maxVel),s=this.startSize||n.Util.randomInRange(this.minSize,this.maxSize),h=o*Math.cos(r),c=o*Math.sin(r),e,i;return this.emitterType===1?(u=n.Util.randomInRange(this.x,this.x+this.getWidth()),f=n.Util.randomInRange(this.y,this.y+this.getHeight())):this.emitterType===0&&(e=n.Util.randomInRange(0,this.radius),u=e*Math.cos(r)+this.x,f=e*Math.sin(r)+this.y),i=new t(this,this.particleLife,this.opacity,this.beginColor,this.endColor,new n.Vector(u,f),new n.Vector(h,c),this.acceleration,this.startSize,this.endSize),i.fadeFlag=this.fadeFlag,i.particleSize=s,this.particleSprite&&(i.particleSprite=this.particleSprite),i.particleRotationalVelocity=this.particleRotationalVelocity,this.randomRotation&&(i.currentRotation=n.Util.randomInRange(0,Math.PI*2)),this.focus&&(i.focus=this.focus.add(new n.Vector(this.x,this.y)),i.focusAccel=this.focusAccel),i},r.prototype.update=function(n,t){var r=this,u;i.prototype.update.call(this,n,t);this.isEmitting&&(this._particlesToEmit+=this.emitRate*(t/1e3),u=Math.ceil(this.emitRate*t/1e3),this._particlesToEmit>1&&(this.emit(Math.floor(this._particlesToEmit)),this._particlesToEmit=this._particlesToEmit-Math.floor(this._particlesToEmit)));this.particles.forEach(function(n){n.update(t)});this.deadParticles.forEach(function(n){r.particles.removeElement(n)});this.deadParticles.clear()},r.prototype.draw=function(n){this.particles.forEach(function(t){t.draw(n)})},r.prototype.debugDraw=function(t){i.prototype.debugDraw.call(this,t);t.fillStyle=n.Color.Black.toString();t.fillText("Particles: "+this.particles.count(),this.x,this.y+20);this.focus&&(t.fillRect(this.focus.x+this.x,this.focus.y+this.y,3,3),n.Util.drawLine(t,"yellow",this.focus.x+this.x,this.focus.y+this.y,i.prototype.getCenter.call(this).x,i.prototype.getCenter.call(this).y),t.fillText("Focus",this.focus.x+this.x,this.focus.y+this.y))},r}(n.Actor);n.ParticleEmitter=i}(ex||(ex={})),function(n){var t=function(){function t(t,i,r,u){this.currentFrame=0;this.oldTime=Date.now();this.anchor=new n.Point(0,0);this.rotation=0;this.scale=new n.Point(1,1);this.loop=!1;this.freezeFrame=-1;this.flipVertical=!1;this.flipHorizontal=!1;this.width=0;this.height=0;this.sprites=i;this.speed=r;this.engine=t;u!=null&&(this.loop=u);this.height=i[0]?i[0].height:0;this.width=i[0]?i[0].width:0}return t.prototype.opacity=function(t){this.addEffect(new n.Effects.Opacity(t))},t.prototype.grayscale=function(){this.addEffect(new n.Effects.Grayscale)},t.prototype.invert=function(){this.addEffect(new n.Effects.Invert)},t.prototype.fill=function(t){this.addEffect(new n.Effects.Fill(t))},t.prototype.colorize=function(t){this.addEffect(new n.Effects.Colorize(t))},t.prototype.lighten=function(t){t===void 0&&(t=.1);this.addEffect(new n.Effects.Lighten(t))},t.prototype.darken=function(t){t===void 0&&(t=.1);this.addEffect(new n.Effects.Darken(t))},t.prototype.saturate=function(t){t===void 0&&(t=.1);this.addEffect(new n.Effects.Saturate(t))},t.prototype.desaturate=function(t){t===void 0&&(t=.1);this.addEffect(new n.Effects.Desaturate(t))},t.prototype.addEffect=function(n){for(var t in this.sprites)this.sprites[t].addEffect(n)},t.prototype.removeEffect=function(n){for(var t in this.sprites)this.sprites[t].removeEffect(n)},t.prototype.clearEffects=function(){for(var n in this.sprites)this.sprites[n].clearEffects()},t.prototype._setAnchor=function(n){for(var t in this.sprites)this.sprites[t].anchor.setTo(n.x,n.y)},t.prototype._setRotation=function(n){for(var t in this.sprites)this.sprites[t].rotation=n},t.prototype._setScale=function(n){for(var t in this.sprites)this.sprites[t].scale=n},t.prototype.reset=function(){this.currentFrame=0},t.prototype.isDone=function(){return!this.loop&&this.currentFrame>=this.sprites.length},t.prototype.tick=function(){var n=Date.now();n-this.oldTime>this.speed&&(this.currentFrame=this.loop?(this.currentFrame+1)%this.sprites.length:this.currentFrame+1,this.oldTime=n)},t.prototype._updateValues=function(){this._setAnchor(this.anchor);this._setRotation(this.rotation);this._setScale(this.scale)},t.prototype.skip=function(n){this.currentFrame=(this.currentFrame+n)%this.sprites.length},t.prototype.draw=function(t,i,r){var u;this.tick();this._updateValues();this.currentFrame<this.sprites.length&&(u=this.sprites[this.currentFrame],this.flipVertical&&(u.flipVertical=this.flipVertical),this.flipHorizontal&&(u.flipHorizontal=this.flipHorizontal),u.draw(t,i,r));this.freezeFrame!==-1&&this.currentFrame>=this.sprites.length&&(u=this.sprites[n.Util.clamp(this.freezeFrame,0,this.sprites.length-1)],u.draw(t,i,r))},t.prototype.play=function(n,t){this.reset();this.engine.playAnimation(this,n,t)},t}();n.Animation=t}(ex||(ex={})),function(n){var t;(function(t){var f=function(){function t(t,u){this.log=n.Logger.getInstance();this.onload=function(){};this.onprogress=function(){};this.onerror=function(){};window.AudioContext?(this.log.debug("Using new Web Audio Api for "+t),this.soundImpl=new r(t,u)):(this.log.debug("Falling back to Audio Element for "+t),this.soundImpl=new i(t,u))}return t.prototype.setVolume=function(n){this.soundImpl.setVolume(n)},t.prototype.setLoop=function(n){this.soundImpl.setLoop(n)},t.prototype.load=function(){this.soundImpl.onload=this.onload;this.soundImpl.onprogress=this.onprogress;this.soundImpl.onerror=this.onerror;this.soundImpl.load()},t.prototype.isPlaying=function(){return this.soundImpl.isPlaying()},t.prototype.play=function(){return this.soundImpl.play()},t.prototype.pause=function(){this.soundImpl.pause()},t.prototype.stop=function(){this.soundImpl.stop()},t}(),i,u,r;t.FallbackAudio=f;i=function(){function t(t,i){var u=this,r;for(this.path=t,this.audioElements=new Array(5),this._loadedAudio=null,this.isLoaded=!1,this.index=0,this.log=n.Logger.getInstance(),this._isPlaying=!1,this._currentOffset=0,this.onload=function(){},this.onprogress=function(){},this.onerror=function(){},r=0;r<this.audioElements.length;r++)(function(n){u.audioElements[n]=new Audio})(r);i?this.setVolume(n.Util.clamp(i,0,1)):this.setVolume(1)}return t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.audioLoaded=function(){this.isLoaded=!0},t.prototype.setVolume=function(n){this.audioElements.forEach(function(t){t.volume=n})},t.prototype.setLoop=function(n){this.audioElements.forEach(function(t){t.loop=n})},t.prototype.getLoop=function(){this.audioElements.some(function(n){return n.loop})},t.prototype.load=function(){var t=this,n=new XMLHttpRequest;n.open("GET",this.path,!0);n.responseType="blob";n.onprogress=this.onprogress;n.onerror=this.onerror;n.onload=function(i){if(n.status!==200){t.log.error("Failed to load audio resource ",t.path," server responded with error code",n.status);t.onerror(n.response);t.isLoaded=!1;return}t._loadedAudio=URL.createObjectURL(n.response);t.audioElements.forEach(function(n){n.src=t._loadedAudio});t.onload(i)};n.send()},t.prototype.play=function(){var i=this,t;return this.audioElements[this.index].load(),this.audioElements[this.index].play(),this._currentOffset=0,t=new n.Promise,this._isPlaying=!0,this.getLoop()||this.audioElements[this.index].addEventListener("ended",function(){i._isPlaying=!1;t.resolve(!0)}),this.index=(this.index+1)%this.audioElements.length,t},t.prototype.pause=function(){this.index=(this.index-1+this.audioElements.length)%this.audioElements.length;this._currentOffset=this.audioElements[this.index].currentTime;this.audioElements.forEach(function(n){n.pause()});this._isPlaying=!1},t.prototype.stop=function(){this.audioElements.forEach(function(n){n.pause()});this._isPlaying=!1},t}();t.AudioTag=i;window.AudioContext&&(u=new window.AudioContext);r=function(){function t(t,i){this.context=u;this.volume=this.context.createGain();this.buffer=null;this.sound=null;this.path="";this.isLoaded=!1;this.loop=!1;this._isPlaying=!1;this._isPaused=!1;this._currentOffset=0;this.logger=n.Logger.getInstance();this.onload=function(){};this.onprogress=function(){};this.onerror=function(){};this.path=t;this.volume.gain.value=i?n.Util.clamp(i,0,1):1}return t.prototype.setVolume=function(n){this.volume.gain.value=n},t.prototype.load=function(){var n=this,t=new XMLHttpRequest;t.open("GET",this.path);t.responseType="arraybuffer";t.onprogress=this.onprogress;t.onerror=this.onerror;t.onload=function(){if(t.status!==200){n.logger.error("Failed to load audio resource ",n.path," server responded with error code",t.status);n.onerror(t.response);n.isLoaded=!1;return}n.context.decodeAudioData(t.response,function(t){n.buffer=t;n.isLoaded=!0;n.onload(n)},function(){n.logger.error("Unable to decode "+n.path+" this browser may not fully support this format, or the file may be corrupt, if this is an mp3 try removing id3 tags and album art from the file.");n.isLoaded=!1;n.onload(n)})};try{t.send()}catch(i){console.error("Error loading sound! If this is a cross origin error, you must host your sound with your html and javascript.")}},t.prototype.setLoop=function(n){this.loop=n},t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.play=function(){var i=this,t;return this.isLoaded?(this.sound=this.context.createBufferSource(),this.sound.buffer=this.buffer,this.sound.loop=this.loop,this.sound.connect(this.volume),this.volume.connect(this.context.destination),this.sound.start(0,this._currentOffset%this.buffer.duration),this._currentOffset=0,t=this._isPaused&&this._playPromise?this._playPromise:new n.Promise,this._isPaused=!1,this._isPlaying=!0,this.loop||(this.sound.onended=function(){i._isPlaying=!1;i._isPaused||t.resolve(!0)}.bind(this)),this._playPromise=t,t):n.Promise.wrap(!0)},t.prototype.pause=function(){if(this._isPlaying)try{window.clearTimeout(this._playingTimer);this.sound.stop(0);this._currentOffset=this.context.currentTime;this._isPlaying=!1;this._isPaused=!0}catch(n){this.logger.warn("The sound clip",this.path,"has already been paused!")}},t.prototype.stop=function(){if(this.sound)try{window.clearTimeout(this._playingTimer);this._currentOffset=0;this.sound.stop(0);this._isPlaying=!1;this._isPaused=!1}catch(n){this.logger.warn("The sound clip",this.path,"has already been stopped!")}},t}();t.WebAudio=r})(t=n.Internal||(n.Internal={}))}(ex||(ex={})),function(n){(function(n){n[n.Resolved=0]="Resolved";n[n.Rejected=1]="Rejected";n[n.Pending=2]="Pending"})(n.PromiseState||(n.PromiseState={}));var i=n.PromiseState,t=function(){function t(){this._state=2;this.successCallbacks=[];this.rejectCallback=function(){};this.logger=n.Logger.getInstance()}return t.wrap=function(n){return(new t).resolve(n)},t.join=function(){for(var n,r=[],f=0;f<arguments.length;f++)r[+f]=arguments[f];if(n=new t,!r||!r.length)return n.resolve();var e=r.length,u=0,o=0,i=[];return r.forEach(function(t){t.then(function(){u+=1;u===e?n.resolve():u+o+i.length===e&&n.reject(i)},function(){o+=1;u+o+i.length===e&&n.reject(i)}).error(function(t){i.push(t);i.length+u+o===e&&n.reject(i)})}),n},t.prototype.then=function(n,t){if(n&&(this.successCallbacks.push(n),this.state()===0))try{n.call(this,this.value)}catch(i){this.handleError(i)}if(t&&(this.rejectCallback=t,this.state()===1))try{t.call(this,this.value)}catch(i){this.handleError(i)}return this},t.prototype.error=function(n){return n&&(this.errorCallback=n),this},t.prototype.resolve=function(n){var t=this;if(this._state===2){this.value=n;try{this._state=0;this.successCallbacks.forEach(function(n){n.call(t,t.value)})}catch(i){this.handleError(i)}}else throw new Error("Cannot resolve a promise that is not in a pending state!");return this},t.prototype.reject=function(n){if(this._state===2){this.value=n;try{this._state=1;this.rejectCallback.call(this,this.value)}catch(t){this.handleError(t)}}else throw new Error("Cannot reject a promise that is not in a pending state!");return this},t.prototype.state=function(){return this._state},t.prototype.handleError=function(n){if(this.errorCallback)this.errorCallback.call(this,n);else throw n;},t}();n.Promise=t}(ex||(ex={})),function(n){var t=function(){function t(t,i,r){r===void 0&&(r=!0);this.path=t;this.responseType=i;this.bustCache=r;this.data=null;this.logger=n.Logger.getInstance();this.onprogress=function(){};this.oncomplete=function(){};this.onerror=function(){}}return t.prototype.isLoaded=function(){return!!this.data},t.prototype.wireEngine=function(n){this._engine=n},t.prototype.cacheBust=function(n){return n+(/\?\w*=\w*/.test(n)?"&__="+Date.now():"?__="+Date.now())},t.prototype._start=function(){this.logger.debug("Started loading resource "+this.path)},t.prototype.load=function(){var i=this,r=new n.Promise,t=new XMLHttpRequest;return t.open("GET",this.bustCache?this.cacheBust(this.path):this.path,!0),t.responseType=this.responseType,t.onloadstart=function(n){i._start(n)},t.onprogress=this.onprogress,t.onerror=this.onerror,t.onload=function(){if(t.status!==200){i.logger.error("Failed to load resource ",i.path," server responded with error code",t.status);i.onerror(t.response);r.resolve(t.response);return}i.data=i.processDownload(t.response);i.oncomplete();i.logger.debug("Completed loading resource",i.path);r.resolve(i.data)},t.send(),r},t.prototype.getData=function(){return this.data},t.prototype.processDownload=function(n){return URL.createObjectURL(n)},t}();n.Resource=t}(ex||(ex={})),function(n){var r=function(t){function i(i,r){r===void 0&&(r=!0);t.call(this,i,"blob",r);this.path=i;this.bustCache=r;this.loaded=new n.Promise;this._isLoaded=!1;this._sprite=null;this._sprite=new n.Sprite(this,0,0,0,0)}return __extends(i,t),i.prototype.isLoaded=function(){return this._isLoaded},i.prototype.load=function(){var i=this,r=new n.Promise,u=t.prototype.load.call(this);return u.then(function(){i.image=new Image;i.image.addEventListener("load",function(){i._isLoaded=!0;i.width=i._sprite.swidth=i._sprite.width=i.image.naturalWidth;i.height=i._sprite.sheight=i._sprite.height=i.image.naturalHeight;i.loaded.resolve(i.image);r.resolve(i.image)});i.image.src=t.prototype.getData.call(i)},function(){r.reject("Error loading texture.")}),r},i.prototype.asSprite=function(){return this._sprite},i}(n.Resource),t,i;n.Texture=r;t=function(){function t(){for(var r,i=[],u=0;u<arguments.length;u++)i[+u]=arguments[u];for(this.logger=n.Logger.getInstance(),this.onprogress=function(){},this.oncomplete=function(){},this.onerror=function(){},this.onload=function(){},this._isLoaded=!1,this._selectedFile="",this._wasPlayingOnHidden=!1,this._selectedFile="",r=0;r<i.length;r++)if(t.canPlayFile(i[r])){this._selectedFile=i[r];break}this._selectedFile||(this.logger.warn("This browser does not support any of the files specified"),this._selectedFile=i[0]);this.sound=new n.Internal.FallbackAudio(this._selectedFile,1)}return t.canPlayFile=function(t){try{var i=new Audio,r=t.match(/.*\.([A-Za-z0-9]+)$/)[1];return i.canPlayType("audio/"+r)?!0:!1}catch(u){return n.Logger.getInstance().warn("Cannot determine audio support, assuming no support for the Audio Tag",u),!1}},t.prototype.wireEngine=function(n){var t=this;if(n){this._engine=n;this._engine.on("hidden",function(){n.pauseAudioWhenHidden&&t.isPlaying()&&(t._wasPlayingOnHidden=!0,t.pause())});this._engine.on("visible",function(){n.pauseAudioWhenHidden&&t._wasPlayingOnHidden&&(t.play(),t._wasPlayingOnHidden=!1)})}},t.prototype.setVolume=function(n){this.sound&&this.sound.setVolume(n)},t.prototype.setLoop=function(n){this.sound&&this.sound.setLoop(n)},t.prototype.isPlaying=function(){if(this.sound)return this.sound.isPlaying()},t.prototype.play=function(){if(this.sound)return this.sound.play()},t.prototype.pause=function(){this.sound&&this.sound.pause()},t.prototype.stop=function(){this.sound&&this.sound.stop()},t.prototype.isLoaded=function(){return this._isLoaded},t.prototype.load=function(){var t=this,i=new n.Promise;return this.logger.debug("Started loading sound",this._selectedFile),this.sound.onprogress=this.onprogress,this.sound.onload=function(){t.oncomplete();t._isLoaded=!0;t.logger.debug("Completed loading sound",t._selectedFile);i.resolve(t.sound)},this.sound.onerror=function(n){t.onerror(n);i.resolve(n)},this.sound.load(),i},t}();n.Sound=t;i=function(){function t(n){this.resourceList=[];this.index=0;this.resourceCount=0;this.numLoaded=0;this.progressCounts={};this.totalCounts={};this.onprogress=function(){};this.oncomplete=function(){};this.onerror=function(){};n&&this.addResources(n)}return t.prototype.wireEngine=function(n){this._engine=n},t.prototype.addResource=function(n){var t=this.index++;this.resourceList.push(n);this.progressCounts[t]=0;this.totalCounts[t]=1;this.resourceCount++},t.prototype.addResources=function(n){var t=this;n.forEach(function(n){t.addResource(n)})},t.prototype.sumCounts=function(n){var t=0;for(var i in n)t+=n[i]|0;return t},t.prototype.isLoaded=function(){return this.numLoaded===this.resourceCount},t.prototype.load=function(){function e(n,t){n[t]&&n[t].load().then(function(){e(n,t+1)})}var u=this,i=new n.Promise,t=this,r,f;return this.resourceList.length===0?(t.oncomplete.call(t),i):(r=new Array(this.resourceList.length),f=this.resourceList.length,this.resourceList.forEach(function(n,e){u._engine&&n.wireEngine(u._engine);n.onprogress=function(n){var u=n.total,o=n.loaded,i;r[e]={loaded:o/u*(100/f),total:100};i=r.reduce(function(n,t){return{loaded:n.loaded+t.loaded,total:100}},{loaded:0,total:100});t.onprogress.call(t,i)};n.oncomplete=n.onerror=function(){t.numLoaded++;t.numLoaded===t.resourceCount&&(t.onprogress.call(t,{loaded:100,total:100}),t.oncomplete.call(t),i.resolve())}}),e(this.resourceList,0),i)},t}();n.Loader=i}(ex||(ex={})),function(n){var i=function(){function t(t){this.path=t;this._isLoaded=!1;this.logger=n.Logger.getInstance();this.onprogress=function(){};this.oncomplete=function(){};this.onerror=function(){};this._innerElement=document.createElement("div");this._innerElement.className="excalibur-template"}return t.prototype.wireEngine=function(n){this._engine=n},t.prototype.getTemplateString=function(){return this._isLoaded?this._htmlString:""},t.prototype._compile=function(){this._innerElement.innerHTML=this._htmlString;this._styleElements=this._innerElement.querySelectorAll("[data-style]");this._textElements=this._innerElement.querySelectorAll("[data-text]")},t.prototype._evaluateExpresion=function(n,t){var i=new Function("return "+n+";");return i.call(t)},t.prototype.apply=function(n){for(var i,t=this,r=0;r<this._styleElements.length;r++)(function(){var i={},u;t._styleElements[r].dataset.style.split(";").forEach(function(n){if(n){var t=n.split(":");i[t[0].trim()]=t[1].trim()}});for(u in i)(function(){var f=i[u];t._styleElements[r].style[u]=t._evaluateExpresion(f,n)})()})();for(i=0;i<this._textElements.length;i++)(function(){var r=t._textElements[i].dataset.text;t._textElements[i].innerText=t._evaluateExpresion(r,n)})();return this._innerElement.children.length===1&&(this._innerElement=this._innerElement.firstChild),this._innerElement},t.prototype.load=function(){var i=this,r=new n.Promise,t=new XMLHttpRequest;return t.open("GET",this.path,!0),t.responseType="text",t.onprogress=this.onprogress,t.onerror=this.onerror,t.onload=function(){if(t.status!==200){i.logger.error("Failed to load html template resource ",i.path," server responded with error code",t.status);i.onerror(t.response);i._isLoaded=!1;r.resolve("error");return}i._htmlString=t.response;i.oncomplete();i.logger.debug("Completed loading template",i.path);i._compile();i._isLoaded=!0;r.resolve(i._htmlString)},t.overrideMimeType&&t.overrideMimeType("text/plain; charset=x-user-defined"),t.send(),r},t.prototype.isLoaded=function(){return this._isLoaded},t}(),t;n.Template=i;t=function(){function n(n,t,i){this.parent=document.getElementById(n);this.template=t;this._ctx=i;this.update()}return n.prototype.listen=function(n,t,i){var r=this;i||(i=function(){r.update()});n.addEventListener&&t.forEach(function(t){n.addEventListener(t,i)})},n.prototype.update=function(){var n=this._applyTemplate(this.template,this._ctx);n instanceof String&&(this.parent.innerHTML=n);n instanceof Node&&this.parent.lastChild!==n&&this.parent.appendChild(n)},n.prototype._applyTemplate=function(n,t){if(n.isLoaded())return n.apply(t)},n}();n.Binding=t}(ex||(ex={})),function(n){var i,r,t;(function(n){n[n.Left=0]="Left";n[n.Right=1]="Right";n[n.Center=2]="Center";n[n.Start=3]="Start";n[n.End=4]="End"})(n.TextAlign||(n.TextAlign={}));i=n.TextAlign,function(n){n[n.Top=0]="Top";n[n.Hanging=1]="Hanging";n[n.Middle=2]="Middle";n[n.Alphabetic=3]="Alphabetic";n[n.Ideographic=4]="Ideographic";n[n.Bottom=5]="Bottom"}(n.BaseAlign||(n.BaseAlign={}));r=n.BaseAlign;t=function(t){function i(i,r,u,f,e){t.call(this,r,u);this.letterSpacing=0;this.caseInsensitive=!0;this._textShadowOn=!1;this._shadowOffsetX=0;this._shadowOffsetY=0;this._shadowColor=n.Color.Black.clone();this._shadowColorDirty=!1;this._textSprites={};this._shadowSprites={};this._color=n.Color.Black.clone();this.text=i||"";this.color=n.Color.Black.clone();this.spriteFont=e;this.collisionType=0;this.font=f||"10px sans-serif";e&&(this._textSprites=e.getTextSprites())}return __extends(i,t),i.prototype.getTextWidth=function(n){var i=n.font,t;return n.font=this.font,t=n.measureText(this.text).width,n.font=i,t},i.prototype._lookupTextAlign=function(n){switch(n){case 0:return"left";case 1:return"right";case 2:return"center";case 4:return"end";case 3:return"start";default:return"start"}},i.prototype._lookupBaseAlign=function(n){switch(n){case 3:return"alphabetic";case 5:return"bottom";case 1:return"hangin";case 4:return"ideographic";case 2:return"middle";case 0:return"top";default:return"alphabetic"}},i.prototype.setTextShadow=function(n,t,i){this._textShadowOn=!0;this._shadowOffsetX=n;this._shadowOffsetY=t;this._shadowColor=i.clone();this._shadowColorDirty=!0;for(var r in this._textSprites)this._shadowSprites[r]=this._textSprites[r].clone()},i.prototype.clearTextShadow=function(){this._textShadowOn=!1;this._shadowOffsetX=0;this._shadowOffsetY=0;this._shadowColor=n.Color.Black.clone()},i.prototype.update=function(i,r){var u;if(t.prototype.update.call(this,i,r),this.spriteFont&&this._color!==this.color)for(u in this._textSprites)this._textSprites[u].clearEffects(),this._textSprites[u].addEffect(new n.Effects.Fill(this.color.clone())),this._color=this.color;if(this.spriteFont&&this._textShadowOn&&this._shadowColorDirty&&this._shadowColor){for(u in this._shadowSprites)this._shadowSprites[u].clearEffects(),this._shadowSprites[u].addEffect(new n.Effects.Fill(this._shadowColor.clone()));this._shadowColorDirty=!1}},i.prototype.draw=function(n,i){n.save();n.translate(this.x,this.y);n.scale(this.scale.x,this.scale.y);n.rotate(this.rotation);this._textShadowOn&&(n.save(),n.translate(this._shadowOffsetX,this._shadowOffsetY),this._fontDraw(n,i,this._shadowSprites),n.restore());this._fontDraw(n,i,this._textSprites);t.prototype.draw.call(this,n,i);n.restore()},i.prototype._fontDraw=function(t,i,r){var o,e,u,f,s,h;if(this.spriteFont){for(o=0,e=0;e<this.text.length;e++){u=this.text[e];this.caseInsensitive&&(u=u.toLowerCase());try{f=r[u];this.previousOpacity!==this.opacity&&(f.clearEffects(),f.addEffect(new n.Effects.Opacity(this.opacity)));f.draw(t,o,0);o+=f.swidth+this.letterSpacing}catch(c){n.Logger.getInstance().error("SpriteFont Error drawing char "+u)}}this.previousOpacity!==this.opacity&&(this.previousOpacity=this.opacity)}else s=t.textAlign,h=t.textBaseline,t.textAlign=this._lookupTextAlign(this.textAlign),t.textBaseline=this._lookupBaseAlign(this.baseAlign),this.color&&(this.color.a=this.opacity),t.fillStyle=this.color.toString(),t.font=this.font,this.maxWidth?t.fillText(this.text,0,0,this.maxWidth):t.fillText(this.text,0,0),t.textAlign=s,t.textBaseline=h},i.prototype.debugDraw=function(n){t.prototype.debugDraw.call(this,n)},i}(n.Actor);n.Label=t}(ex||(ex={})),function(n){var t;(function(t){var f,e,o,i,u,r;(function(n){n[n.Touch=0]="Touch";n[n.Mouse=1]="Mouse";n[n.Pen=2]="Pen";n[n.Unknown=3]="Unknown"})(t.PointerType||(t.PointerType={}));f=t.PointerType,function(n){n[n.Left=0]="Left";n[n.Middle=1]="Middle";n[n.Right=2]="Right";n[n.Unknown=3]="Unknown"}(t.PointerButton||(t.PointerButton={}));e=t.PointerButton,function(n){n[n.Canvas=0]="Canvas";n[n.Document=1]="Document"}(t.PointerScope||(t.PointerScope={}));o=t.PointerScope;i=function(n){function t(t,i,r,u,f,e){n.call(this);this.x=t;this.y=i;this.index=r;this.pointerType=u;this.button=f;this.ev=e}return __extends(t,n),t}(n.GameEvent);t.PointerEvent=i;u=function(t){function u(n){t.call(this);this._pointerDown=[];this._pointerUp=[];this._pointerMove=[];this._pointerCancel=[];this._pointers=[];this._activePointers=[];this._engine=n;this._pointers.push(new r);this._activePointers=[-1];this.primary=this._pointers[0]}return __extends(u,t),u.prototype.init=function(n){n===void 0&&(n=1);var t=document;t=n===1?document:this._engine.canvas;t.addEventListener("touchstart",this._handleTouchEvent("down",this._pointerDown));t.addEventListener("touchend",this._handleTouchEvent("up",this._pointerUp));t.addEventListener("touchmove",this._handleTouchEvent("move",this._pointerMove));t.addEventListener("touchcancel",this._handleTouchEvent("cancel",this._pointerCancel));window.PointerEvent?(this._engine.canvas.style.touchAction="none",t.addEventListener("pointerdown",this._handlePointerEvent("down",this._pointerDown)),t.addEventListener("pointerup",this._handlePointerEvent("up",this._pointerUp)),t.addEventListener("pointermove",this._handlePointerEvent("move",this._pointerMove)),t.addEventListener("pointercancel",this._handlePointerEvent("cancel",this._pointerMove))):window.MSPointerEvent?(this._engine.canvas.style.msTouchAction="none",t.addEventListener("MSPointerDown",this._handlePointerEvent("down",this._pointerDown)),t.addEventListener("MSPointerUp",this._handlePointerEvent("up",this._pointerUp)),t.addEventListener("MSPointerMove",this._handlePointerEvent("move",this._pointerMove)),t.addEventListener("MSPointerCancel",this._handlePointerEvent("cancel",this._pointerMove))):(t.addEventListener("mousedown",this._handleMouseEvent("down",this._pointerDown)),t.addEventListener("mouseup",this._handleMouseEvent("up",this._pointerUp)),t.addEventListener("mousemove",this._handleMouseEvent("move",this._pointerMove)))},u.prototype.update=function(){this._pointerUp.length=0;this._pointerDown.length=0;this._pointerMove.length=0;this._pointerCancel.length=0},u.prototype.at=function(n){if(n>=this._pointers.length)for(var t=this._pointers.length-1,i=n;t<i;t++)this._pointers.push(new r),this._activePointers.push(-1);return this._pointers[n]},u.prototype.count=function(){return this._pointers.length},u.prototype.propogate=function(t){var i=t instanceof n.UIActor;this._pointerUp.forEach(function(n){t.contains(n.x,n.y,!i)&&t.eventDispatcher.publish("pointerup",n)});this._pointerDown.forEach(function(n){t.contains(n.x,n.y,!i)&&t.eventDispatcher.publish("pointerdown",n)});t.capturePointer.captureMoveEvents&&this._pointerMove.forEach(function(n){t.contains(n.x,n.y,!i)&&t.eventDispatcher.publish("pointermove",n)});this._pointerCancel.forEach(function(n){t.contains(n.x,n.y,!i)&&t.eventDispatcher.publish("pointercancel",n)})},u.prototype._handleMouseEvent=function(t,r){var u=this;return function(f){f.preventDefault();var s=f.pageX-n.Util.getPosition(u._engine.canvas).x,h=f.pageY-n.Util.getPosition(u._engine.canvas).y,e=u._engine.screenToWorldCoordinates(new n.Point(s,h)),o=new i(e.x,e.y,0,1,f.button,f);r.push(o);u.at(0).eventDispatcher.publish(t,o)}},u.prototype._handleTouchEvent=function(t,r){var u=this;return function(f){var e,s,o;for(f.preventDefault(),e=0,s=f.changedTouches.length;e<s;e++)if(o=u._pointers.length>1?u._getPointerIndex(f.changedTouches[e].identifier):0,o!==-1){var l=f.changedTouches[e].pageX-n.Util.getPosition(u._engine.canvas).x,a=f.changedTouches[e].pageY-n.Util.getPosition(u._engine.canvas).y,h=u._engine.screenToWorldCoordinates(new n.Point(l,a)),c=new i(h.x,h.y,o,0,3,f);r.push(c);u.at(o).eventDispatcher.publish(t,c);u._pointers.length>1&&(t==="up"?u._activePointers[o]=-1:t==="down"&&(u._activePointers[o]=f.changedTouches[e].identifier))}}},u.prototype._handlePointerEvent=function(t,r){var u=this;return function(f){var e;if(f.preventDefault(),e=u._pointers.length>1?u._getPointerIndex(f.pointerId):0,e!==-1){var h=f.pageX-n.Util.getPosition(u._engine.canvas).x,c=f.pageY-n.Util.getPosition(u._engine.canvas).y,o=u._engine.screenToWorldCoordinates(new n.Point(h,c)),s=new i(o.x,o.y,e,u._stringToPointerType(f.pointerType),f.button,f);r.push(s);u.at(e).eventDispatcher.publish(t,s);u._pointers.length>1&&(t==="up"?u._activePointers[e]=-1:t==="down"&&(u._activePointers[e]=f.pointerId))}}},u.prototype._getPointerIndex=function(n){var i,t;if((i=this._activePointers.indexOf(n))>-1)return i;for(t=0;t<this._activePointers.length;t++)if(this._activePointers[t]===-1)return t;return-1},u.prototype._stringToPointerType=function(n){switch(n){case"touch":return 0;case"mouse":return 1;case"pen":return 2;default:return 3}},u}(n.Class);t.Pointers=u;r=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t}(n.Class);t.Pointer=r})(t=n.Input||(n.Input={}))}(ex||(ex={})),function(n){var t;(function(t){var u,i,r;(function(n){n[n.Num1=97]="Num1";n[n.Num2=98]="Num2";n[n.Num3=99]="Num3";n[n.Num4=100]="Num4";n[n.Num5=101]="Num5";n[n.Num6=102]="Num6";n[n.Num7=103]="Num7";n[n.Num8=104]="Num8";n[n.Num9=105]="Num9";n[n.Num0=96]="Num0";n[n.Numlock=144]="Numlock";n[n.Semicolon=186]="Semicolon";n[n.A=65]="A";n[n.B=66]="B";n[n.C=67]="C";n[n.D=68]="D";n[n.E=69]="E";n[n.F=70]="F";n[n.G=71]="G";n[n.H=72]="H";n[n.I=73]="I";n[n.J=74]="J";n[n.K=75]="K";n[n.L=76]="L";n[n.M=77]="M";n[n.N=78]="N";n[n.O=79]="O";n[n.P=80]="P";n[n.Q=81]="Q";n[n.R=82]="R";n[n.S=83]="S";n[n.T=84]="T";n[n.U=85]="U";n[n.V=86]="V";n[n.W=87]="W";n[n.X=88]="X";n[n.Y=89]="Y";n[n.Z=90]="Z";n[n.Shift=16]="Shift";n[n.Alt=18]="Alt";n[n.Up=38]="Up";n[n.Down=40]="Down";n[n.Left=37]="Left";n[n.Right=39]="Right";n[n.Space=32]="Space";n[n.Esc=27]="Esc"})(t.Keys||(t.Keys={}));u=t.Keys;i=function(n){function t(t){n.call(this);this.key=t}return __extends(t,n),t}(n.GameEvent);t.KeyEvent=i;r=function(n){function t(t){n.call(this);this._keys=[];this._keysUp=[];this._keysDown=[];this._engine=t}return __extends(t,n),t.prototype.init=function(){var n=this;window.addEventListener("blur",function(){n._keys.length=0});window.addEventListener("keyup",function(t){var u=n._keys.indexOf(t.keyCode),r;n._keys.splice(u,1);n._keysUp.push(t.keyCode);r=new i(t.keyCode);n.eventDispatcher.publish("up",r)});window.addEventListener("keydown",function(t){if(n._keys.indexOf(t.keyCode)===-1){n._keys.push(t.keyCode);n._keysDown.push(t.keyCode);var r=new i(t.keyCode);n.eventDispatcher.publish("down",r)}})},t.prototype.update=function(){this._keysDown.length=0;this._keysUp.length=0},t.prototype.getKeys=function(){return this._keys},t.prototype.isKeyDown=function(n){return this._keysDown.indexOf(n)>-1},t.prototype.isKeyPressed=function(n){return this._keys.indexOf(n)>-1},t.prototype.isKeyUp=function(n){return this._keysUp.indexOf(n)>-1},t}(n.Class);t.Keyboard=r})(t=n.Input||(n.Input={}))}(ex||(ex={})),function(n){var t;(function(t){var o=function(n){function t(t){n.call(this);this.enabled=!1;this.supported=!!navigator.getGamepads;this._gamePadTimeStamps=[0,0,0,0];this._oldPads=[];this._pads=[];this._initSuccess=!1;this._navigator=navigator;this._engine=t}return __extends(t,n),t.prototype.init=function(){this.supported&&(this._initSuccess||(this._oldPads=this._clonePads(this._navigator.getGamepads()),this._oldPads.length&&this._oldPads[0]&&(this._initSuccess=!0)))},t.prototype.update=function(){var t,n,h,c,i,o,s;if(this.enabled&&this.supported)for(this.init(),t=this._navigator.getGamepads(),n=0;n<t.length;n++){if(t[n])this.at(n).connected=!0;else{this.at(n).connected=!1;continue}if(!t[n].timestamp||t[n].timestamp!==this._gamePadTimeStamps[n]){this._gamePadTimeStamps[n]=t[n].timestamp;for(h in r)typeof r[h]=="number"&&(o=r[h],i=t[n].buttons[o].value,i!==this._oldPads[n].getButton(o)&&(t[n].buttons[o].pressed?(this.at(n).updateButton(o,i),this.at(n).eventDispatcher.publish("button",new f(o,i))):this.at(n).updateButton(o,0)));for(c in u)typeof u[c]=="number"&&(s=u[c],i=t[n].axes[s],i!==this._oldPads[n].getAxes(s)&&(this.at(n).updateAxes(s,i),this.at(n).eventDispatcher.publish("axis",new e(s,i))));this._oldPads[n]=this._clonePad(t[n])}}},t.prototype.at=function(n){if(n>=this._pads.length)for(var t=this._pads.length-1,r=n;t<r;t++)this._pads.push(new i),this._oldPads.push(new i);return this._pads[n]},t.prototype.count=function(){return this._pads.filter(function(n){return n.connected}).length},t.prototype._clonePads=function(n){for(var i=[],t=0,r=n.length;t<r;t++)i.push(this._clonePad(n[t]));return i},t.prototype._clonePad=function(n){var t,r,u=new i;if(!n)return u;for(t=0,r=n.buttons.length;t<r;t++)u.updateButton(t,n.buttons[t].value);for(t=0,r=n.axes.length;t<r;t++)u.updateAxes(t,n.axes[t]);return u},t.MinAxisMoveThreshold=.05,t}(n.Class),i,r,u,f,e;t.Gamepads=o;i=function(n){function t(){n.call(this);this.connected=!1;this._buttons=new Array(16);this._axes=new Array(4);for(var t=0;t<this._buttons.length;t++)this._buttons[t]=0;for(t=0;t<this._axes.length;t++)this._axes[t]=0}return __extends(t,n),t.prototype.isButtonPressed=function(n,t){return t===void 0&&(t=1),this._buttons[n]>=t},t.prototype.getButton=function(n){return this._buttons[n]},t.prototype.getAxes=function(n){var t=this._axes[n];return Math.abs(t)<o.MinAxisMoveThreshold?0:t},t.prototype.updateButton=function(n,t){this._buttons[n]=t},t.prototype.updateAxes=function(n,t){this._axes[n]=t},t}(n.Class);t.Gamepad=i,function(n){n[n.Face1=0]="Face1";n[n.Face2=1]="Face2";n[n.Face3=2]="Face3";n[n.Face4=3]="Face4";n[n.LeftBumper=4]="LeftBumper";n[n.RightBumper=5]="RightBumper";n[n.LeftTrigger=6]="LeftTrigger";n[n.RightTrigger=7]="RightTrigger";n[n.Select=8]="Select";n[n.Start=9]="Start";n[n.LeftStick=10]="LeftStick";n[n.RightStick=11]="RightStick";n[n.DpadUp=12]="DpadUp";n[n.DpadDown=13]="DpadDown";n[n.DpadLeft=14]="DpadLeft";n[n.DpadRight=15]="DpadRight"}(t.Buttons||(t.Buttons={}));r=t.Buttons,function(n){n[n.LeftStickX=0]="LeftStickX";n[n.LeftStickY=1]="LeftStickY";n[n.RightStickX=2]="RightStickX";n[n.RightStickY=3]="RightStickY"}(t.Axes||(t.Axes={}));u=t.Axes;f=function(n){function t(t,i){n.call(this);this.button=t;this.value=i}return __extends(t,n),t}(n.GameEvent);t.GamepadButtonEvent=f;e=function(n){function t(t,i){n.call(this);this.axis=t;this.value=i}return __extends(t,n),t}(n.GameEvent);t.GamepadAxisEvent=e})(t=n.Input||(n.Input={}))}(ex||(ex={})),function(n){(function(n){n[n.FullScreen=0]="FullScreen";n[n.Container=1]="Container";n[n.Fixed=2]="Fixed"})(n.DisplayMode||(n.DisplayMode={}));var r=n.DisplayMode,t=function(){function n(n,t,i){this.animation=n;this.x=t;this.y=i}return n}(),i=function(i){function r(){i.call(this);this.collisionStrategy=1;this.hasStarted=!1;this.fps=0;this.postProcessors=[];this.scenes={};this.animations=[];this.isFullscreen=!1;this.displayMode=0;this.pauseAudioWhenHidden=!0;this.isDebug=!1;this.debugColor=new n.Color(255,255,255);this.backgroundColor=new n.Color(0,0,100);this.isSmoothingEnabled=!0;this.isLoading=!1;this.progress=0;this.total=1;var t,r,u,e,f=null;typeof arguments[0]=="number"?(t=arguments[0],r=arguments[1],u=arguments[2],e=arguments[3]):(f=arguments[0],t=f.width,r=f.height,u=f.canvasElementId,e=f.displayMode);this.logger=n.Logger.getInstance();this.logger.info("Powered by Excalibur.js visit","http://excaliburjs.com","for more information.");this.logger.debug("Building engine...");this.canvasElementId=u;u?(this.logger.debug("Using Canvas element specified: "+u),this.canvas=document.getElementById(u)):(this.logger.debug("Using generated canvas element"),this.canvas=document.createElement("canvas"));t&&r?(e==undefined&&(this.displayMode=2),this.logger.debug("Engine viewport is size "+t+" x "+r),this.width=t,this.canvas.width=t,this.height=r,this.canvas.height=r):e||(this.logger.debug("Engine viewport is fullscreen"),this.displayMode=0);this.loader=new n.Loader;this.initialize(f);this.rootScene=this.currentScene=new n.Scene(this);this.addScene("root",this.rootScene);this.goToScene("root")}return __extends(r,i),r.prototype.playAnimation=function(n,i,r){this.animations.push(new t(n,i,r))},r.prototype.addChild=function(n){this.currentScene.addChild(n)},r.prototype.removeChild=function(n){this.currentScene.removeChild(n)},r.prototype.addTileMap=function(n){this.currentScene.addTileMap(n)},r.prototype.removeTileMap=function(n){this.currentScene.removeTileMap(n)},r.prototype.addTimer=function(n){return this.currentScene.addTimer(n)},r.prototype.removeTimer=function(n){return this.currentScene.removeTimer(n)},r.prototype.addScene=function(n,t){this.scenes[n]&&this.logger.warn("Scene",n,"already exists overwriting");this.scenes[n]=t;t.engine=this},r.prototype.removeScene=function(t){if(t instanceof n.Scene)for(var i in this.scenes)this.scenes.hasOwnProperty(i)&&this.scenes[i]===t&&delete this.scenes[i];typeof t=="string"&&delete this.scenes[t]},r.prototype.add=function(t){if(t instanceof n.UIActor){this.currentScene.addUIActor(t);return}t instanceof n.Actor&&this.addChild(t);t instanceof n.Timer&&this.addTimer(t);t instanceof n.TileMap&&this.addTileMap(t);arguments.length===2&&this.addScene(arguments[0],arguments[1])},r.prototype.remove=function(t){if(t instanceof n.UIActor){this.currentScene.removeUIActor(t);return}t instanceof n.Actor&&this.removeChild(t);t instanceof n.Timer&&this.removeTimer(t);t instanceof n.TileMap&&this.removeTileMap(t);t instanceof n.Scene&&this.removeScene(t);typeof t=="string"&&this.removeScene(t)},r.prototype.goToScene=function(t){if(this.scenes[t]){var r=this.currentScene,i=this.scenes[t];this.logger.debug("Going to scene:",t);this.currentScene.isInitialized&&(this.currentScene.onDeactivate.call(this.currentScene),this.currentScene.eventDispatcher.publish("deactivate",new n.DeactivateEvent(i)));this.currentScene=i;this.currentScene.isInitialized||(this.currentScene.onInitialize.call(this.currentScene,this),this.currentScene.eventDispatcher.publish("initialize",new n.InitializeEvent(this)),this.currentScene.isInitialized=!0);this.currentScene.onActivate.call(this.currentScene);this.currentScene.eventDispatcher.publish("activate",new n.ActivateEvent(r))}else this.logger.error("Scene",t,"does not exist!")},r.prototype.getWidth=function(){return this.currentScene&&this.currentScene.camera?this.width/this.currentScene.camera.getZoom():this.width},r.prototype.getHeight=function(){return this.currentScene&&this.currentScene.camera?this.height/this.currentScene.camera.getZoom():this.height},r.prototype.screenToWorldCoordinates=function(t){var i=t.x,r=t.y,u;return this.currentScene&&this.currentScene.camera&&(u=this.currentScene.camera.getFocus(),i=u.x+(t.x-this.getWidth()/2),r=u.y+(t.y-this.getHeight()/2)),i=Math.floor(i/this.canvas.clientWidth*this.getWidth()),r=Math.floor(r/this.canvas.clientHeight*this.getHeight()),new n.Point(i,r)},r.prototype.worldToScreenCoordinates=function(t){var i=t.x,r=t.y,u;return this.currentScene&&this.currentScene.camera&&(u=this.currentScene.camera.getFocus(),i=t.x-u.x+this.getWidth()/2,r=t.y-u.y+this.getHeight()/2),i=Math.floor(i/this.getWidth()*this.canvas.clientWidth),r=Math.floor(r/this.getHeight()*this.canvas.clientHeight),new n.Point(i,r)},r.prototype.setHeightByDisplayMode=function(n){this.displayMode===1&&(this.width=this.canvas.width=n.clientWidth,this.height=this.canvas.height=n.clientHeight);this.displayMode===0&&(document.body.style.margin="0px",document.body.style.overflow="hidden",this.width=this.canvas.width=n.innerWidth,this.height=this.canvas.height=n.innerHeight)},r.prototype.initialize=function(t){var i=this,r;(this.displayMode===0||this.displayMode===1)&&(r=this.displayMode===1?this.canvas.parentElement||document.body:window,this.setHeightByDisplayMode(r),window.addEventListener("resize",function(){i.logger.debug("View port resized");i.setHeightByDisplayMode(r);i.logger.info("parent.clientHeight "+r.clientHeight);i.setAntialiasing(i.isSmoothingEnabled)}));this.input={keyboard:new n.Input.Keyboard(this),pointers:new n.Input.Pointers(this),gamepads:new n.Input.Gamepads(this)};this.input.keyboard.init();this.input.pointers.init(t?t.pointerScope:1);this.input.gamepads.init();document.addEventListener("visibilitychange",function(){document.hidden||document.msHidden?(i.eventDispatcher.publish("hidden",new n.HiddenEvent),i.logger.debug("Window hidden")):(i.eventDispatcher.publish("visible",new n.VisibleEvent),i.logger.debug("Window visible"))});this.ctx=this.canvas.getContext("2d");this.canvasElementId||document.body.appendChild(this.canvas)},r.prototype.setAntialiasing=function(n){this.isSmoothingEnabled=n;this.ctx.imageSmoothingEnabled=n;this.ctx.webkitImageSmoothingEnabled=n;this.ctx.mozImageSmoothingEnabled=n;this.ctx.msImageSmoothingEnabled=n},r.prototype.getAntialiasing=function(){return this.ctx.imageSmoothingEnabled||this.ctx.webkitImageSmoothingEnabled||this.ctx.mozImageSmoothingEnabled||this.ctx.msImageSmoothingEnabled},r.prototype.update=function(t){this.isLoading||(this.currentScene.update(this,t),this.animations=this.animations.filter(function(n){return!n.animation.isDone()}),this.input.keyboard.update(t),this.input.pointers.update(t),this.input.gamepads.update(t),this.eventDispatcher.publish(n.EventType[5],new n.UpdateEvent(t)))},r.prototype.draw=function(t){var i=this.ctx,u,r,f;if(this.isLoading){i.fillStyle="black";i.fillRect(0,0,this.width,this.height);this.drawLoadingBar(i,this.progress,this.total);return}if(i.clearRect(0,0,this.width,this.height),i.fillStyle=this.backgroundColor.toString(),i.fillRect(0,0,this.width,this.height),this.currentScene.draw(this.ctx,t),this.animations.forEach(function(n){n.animation.draw(i,n.x,n.y)}),this.fps=1e3/t,this.isDebug){for(this.ctx.font="Consolas",this.ctx.fillStyle=this.debugColor.toString(),u=this.input.keyboard.getKeys(),r=0;r<u.length;r++)this.ctx.fillText(u[r].toString()+" : "+(n.Input.Keys[u[r]]?n.Input.Keys[u[r]]:"Not Mapped"),100,10*r+10);this.ctx.fillText("FPS:"+this.fps.toFixed(2).toString(),10,10)}for(f=0;f<this.postProcessors.length;f++)this.postProcessors[f].process(this.ctx.getImageData(0,0,this.width,this.height),this.ctx)},r.prototype.start=function(t){var r,u,i;return t?(t.wireEngine(this),r=this.load(t)):r=n.Promise.wrap(),this.hasStarted||(this.hasStarted=!0,this.logger.debug("Starting game..."),u=Date.now(),i=this,function f(){if(i.hasStarted){window.requestAnimationFrame(f);var t=Date.now(),n=Math.floor(t-u)||1;n>200&&(n=1);i.update(n);i.draw(n);u=t}}(),this.logger.debug("Game started")),r},r.prototype.stop=function(){this.hasStarted&&(this.hasStarted=!1,this.logger.debug("Game stopped"))},r.prototype.screenshot=function(){var n=new Image,t=this.canvas.toDataURL("image/png");return n.src=t,n},r.prototype.drawLoadingBar=function(n,t,i){var o,h,c;if(this.loadingDraw){this.loadingDraw(n,t,i);return}var f=this.canvas.height/2,r=this.canvas.width/3,e=r,s=new Image;s.src="data:image/png;base64,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";o=r*3/8;h=this.getAntialiasing();this.setAntialiasing(!0);n.drawImage(s,0,0,800,300,e,f-o-20,r,o);n.strokeStyle="white";n.lineWidth=2;n.strokeRect(e,f,r,20);c=r*(t/i);n.fillStyle="white";var u=5,r=c-u*2,l=20-u*2;n.fillRect(e+u,f+u,r>0?r:0,l);this.setAntialiasing(h)},r.prototype.setLoadingDrawFunction=function(n){this.loadingDraw=n},r.prototype.load=function(t){var i=this,r=new n.Promise;return this.isLoading=!0,t.onprogress=function(n){i.progress=n.loaded;i.total=n.total;i.logger.debug("Loading "+(100*i.progress/i.total).toFixed(0))},t.oncomplete=function(){setTimeout(function(){i.isLoading=!1;r.resolve()},500)},t.load(),r},r}(n.Class);n.Engine=i}(ex||(ex={}));typeof module!="undefined"&&(module.exports=ex);
//# sourceMappingURL=excalibur.min.js.map
